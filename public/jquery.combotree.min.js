!function(e){function t(n){if(o[n])return o[n].exports;var a=o[n]={exports:{},id:n,loaded:!1};return e[n].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var o={};return t.m=e,t.c=o,t.p="",t(0)}([function(e,t,o){e.exports=o(1)},function(e,t){"use strict";!function(e){var t={init:function(o){return this.each(function(){var n={slideDur:400},a=e.extend({},n,o),i=e(this);for(var s in a)i.data(s,a[s]);e(i.data("element")).addClass("combotree"),t.renderField(i),e(document).bind("mouseup",t.onWindowMouseUp),e.extend(e.expr[":"],{containsIN:function(e,t,o){return(e.innerText||"").toLowerCase().indexOf((o[3]||"").toLowerCase())>=0}})})},renderField:function(o){o.data("label")&&e('<label class="combotree__label" for="combotree__search">'+o.data("label")+"</label>").appendTo(e(o.data("element")));var n=e('<div class="combotree__field"></div>').appendTo(e(o.data("element")));o.data("label")||n.addClass("without-label");var a=o.data("placeholder")||"",i=e('<input id="combotree__input" class="combotree__input" type="search" placeholder="'+a+'">').appendTo(n).bind("keyup",t.onInputChange);e('<button class="combotree__btn" type="button">').appendTo(n).bind("click",t.onSelectClick);var s=o.data("listHeight")||"240";if(e('<div class="combotree__list-wrapper"></div>').appendTo(e(o.data("element"))).css("max-height",s+"px"),o.data("value")){var r=t.findDefaultItem(o.data("data").children,o.data("value"));i.val(r.name)}},renderList:function(e){t.renderNodes(e.data("data").children,e.find(".combotree__list-wrapper"))},renderNodes:function(o,n){o&&!function(){var a=e('<ul class="combotree__list"></ul>');a.appendTo(n),o.sort(function(e,t){var o=e.name.toUpperCase(),n=t.name.toUpperCase();return o<n?-1:o>n?1:0}),o.forEach(function(e){n=t.renderItem(e.name,a,!e.children),t.renderNodes(e.children,n)})}()},renderItem:function(t,o,n){var a=n?"combotree__item_last-level":"",i=e('<li class="combotree__item '+a+'">'+t+"</li>");return i.appendTo(o),i},showList:function(o){var n=o.data("listHeight")||"240";o.offset().top+o.height()+ +n<e(window).height()?o.find(".combotree__list-wrapper").slideDown(o.data("slideDur")).bind("click",t.onItemClick):o.find(".combotree__list-wrapper").addClass("openToTop").slideDown(o.data("slideDur")).bind("click",t.onItemClick),t.renderList(o);var a=o.find(".combotree__input").val();""!==a&&t.searchItem(a,o),o.addClass("open")},hideList:function(e){e.find(".combotree__list-wrapper").slideUp(e.data("slideDur")).unbind("click",t.onItemClick),e.find(".combotree__list-wrapper").children().removeClass("open").removeClass("hidden"),setTimeout(function(){e.removeClass("open"),e.find(".combotree__list-wrapper").removeClass("openToTop").children().remove()},550)},searchItem:function(t,o){o.find('.combotree__item_last-level:containsIN("'+t+'")').addClass("search-result"),o.find(".search-result").each(function(){e(this).parents(".combotree__item").each(function(){e(this).addClass("open")}),e(this).parents(".combotree__list").each(function(){e(this).addClass("open")})})},findDefaultItem:function(e,o){for(var n=0;n<e.length;n++){if(e[n].id===o)return e[n];if(e[n].children){var a=t.findDefaultItem(e[n].children,o);if(a)return a}}return null},showListNoResultText:function(t){t.find(".combotree__list-wrapper").children().hasClass("hidden")&&!t.find(".combotree__search_no-result").length&&e('<p class="combotree__search_no-result">Ничего не найдено</p>').appendTo(t.find(".combotree__list-wrapper"))},hideListOptionsNotComplySearchConditions:function(o){o.find(".combotree__item_last-level").each(function(){e(this).hasClass("search-result")||e(this).addClass("hidden")}),o.find(".combotree__list").each(function(){t.hideListEmptyParents(e(this))}),o.find(".combotree__item").not(".combotree__item_last-level").each(function(){t.hideListEmptyParents(e(this))})},hideListEmptyParents:function(t){var o=!1;t.find(".combotree__item_last-level").each(function(){if(e(this).hasClass("search-result"))return o=!0,!1}),o||t.removeClass("open").addClass("hidden")},resetSearchResult:function(e){e.find(".combotree__list").removeClass("hidden"),e.find(".combotree__item").removeClass("hidden"),e.find(".combotree__item_last-level").removeClass("search-result"),e.find(".combotree__search_no-result").remove()},onInputChange:function(o){var n=e(o.target),a=e(o.target).parents(".combotree");0===n.val().length?a.hasClass("open")&&t.resetSearchResult(a):a.hasClass("open")?(t.resetSearchResult(a),t.searchItem(n.val(),a),t.hideListOptionsNotComplySearchConditions(a),t.showListNoResultText(a)):(t.showList(a),t.searchItem(n.val(),a),t.hideListOptionsNotComplySearchConditions(a),t.showListNoResultText(a))},onSelectClick:function(o){o.preventDefault();var n=e(o.target).parents(".combotree");n.hasClass("open")?t.hideList(n):t.showList(n)},onItemClick:function(o){o.stopPropagation();var n=e(o.target),a=n.parents(".combotree");n.hasClass("combotree__item")&&(n.hasClass("combotree__item_last-level")?(a.find(".combotree__input").val(n.text()),t.hideList(a)):(o.stopPropagation(),n.hasClass("open")?(n.children().slideUp(a.data("slideDur")),setTimeout(function(){n.removeClass("open")},400)):(n.children().slideDown(a.data("slideDur")),n.addClass("open"))))},onWindowMouseUp:function(o){0===e(".combotree.open").has(o.target).length&&t.hideList(e(".combotree.open"))}};e.fn.combotree=function(e){return t.init.apply(this,arguments)}}(jQuery)}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vanF1ZXJ5LmNvbWJvdHJlZS5qcyIsIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgMDRiOWFmZGYyYjgzZDc3MmE4ZWYiLCJ3ZWJwYWNrOi8vLy4vc3JjL2pxdWVyeS5jb21ib3RyZWUuanMiXSwibmFtZXMiOlsibW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImluc3RhbGxlZE1vZHVsZXMiLCJleHBvcnRzIiwibW9kdWxlIiwiaWQiLCJsb2FkZWQiLCJjYWxsIiwibSIsImMiLCJwIiwiJCIsIm1ldGhvZHMiLCJpbml0IiwicGFyYW1zIiwidGhpcyIsImVhY2giLCJjb25maWciLCJzbGlkZUR1ciIsIm9wdGlvbnMiLCJleHRlbmQiLCIkdGhpcyIsImtleSIsImRhdGEiLCJhZGRDbGFzcyIsInJlbmRlckZpZWxkIiwiZG9jdW1lbnQiLCJiaW5kIiwib25XaW5kb3dNb3VzZVVwIiwiZXhwciIsImNvbnRhaW5zSU4iLCJlbGVtIiwiaSIsIm1hdGNoIiwiaW5uZXJUZXh0IiwidG9Mb3dlckNhc2UiLCJpbmRleE9mIiwiZWxlbWVudCIsImFwcGVuZFRvIiwiaW5wdXRDb250YWluZXIiLCJwbGFjZWhvbGRlciIsImlucHV0Iiwib25JbnB1dENoYW5nZSIsIm9uU2VsZWN0Q2xpY2siLCJsaXN0TWF4SGVpZ2h0IiwiY3NzIiwiZGVmYXVsdFZhbHVlIiwiZmluZERlZmF1bHRJdGVtIiwiY2hpbGRyZW4iLCJ2YWwiLCJuYW1lIiwicmVuZGVyTGlzdCIsInJlbmRlck5vZGVzIiwiZmluZCIsImNoaWxkcmVuRGF0YU9iaiIsInBhcmVudEVsZW1lbnQiLCJjaGlsZENvbnRhaW5lciIsInNvcnQiLCJhIiwiYiIsImNvbXBBIiwidG9VcHBlckNhc2UiLCJjb21wQiIsImZvckVhY2giLCJjaGlsZCIsInJlbmRlckl0ZW0iLCJwYXJlbnQiLCJpc0xhc3RMZXZlbCIsImxhc3RMZXZlbENsYXNzIiwiaXRlbUVsZW1lbnQiLCJzaG93TGlzdCIsIm9mZnNldCIsInRvcCIsImhlaWdodCIsIndpbmRvdyIsInNsaWRlRG93biIsIm9uSXRlbUNsaWNrIiwiaW5wdXRWYWx1ZSIsInNlYXJjaEl0ZW0iLCJoaWRlTGlzdCIsInNsaWRlVXAiLCJ1bmJpbmQiLCJyZW1vdmVDbGFzcyIsInNldFRpbWVvdXQiLCJyZW1vdmUiLCJzZWFyY2hDb25kaXRpb24iLCJwYXJlbnRzIiwiY2hpbGRyZW5EYXRhIiwiZGVmYXVsdFZhbHVlSWQiLCJsZW5ndGgiLCJyZXMiLCJzaG93TGlzdE5vUmVzdWx0VGV4dCIsImhhc0NsYXNzIiwiaGlkZUxpc3RPcHRpb25zTm90Q29tcGx5U2VhcmNoQ29uZGl0aW9ucyIsImhpZGVMaXN0RW1wdHlQYXJlbnRzIiwibm90IiwiaGFzU2hvd0xpc3RlZEl0ZW0iLCJyZXNldFNlYXJjaFJlc3VsdCIsImV2ZW50IiwiJGlucHV0IiwidGFyZ2V0IiwiJGNvbWJvdHJlZSIsInByZXZlbnREZWZhdWx0Iiwic3RvcFByb3BhZ2F0aW9uIiwiJGl0ZW0iLCJ0ZXh0IiwiaGFzIiwiZm4iLCJjb21ib3RyZWUiLCJzZXR0aW5ncyIsImFwcGx5IiwiYXJndW1lbnRzIiwialF1ZXJ5Il0sIm1hcHBpbmdzIjoiQ0FBUyxTQUFVQSxHQ0luQixRQUFBQyxHQUFBQyxHQUdBLEdBQUFDLEVBQUFELEdBQ0EsTUFBQUMsR0FBQUQsR0FBQUUsT0FHQSxJQUFBQyxHQUFBRixFQUFBRCxJQUNBRSxXQUNBRSxHQUFBSixFQUNBSyxRQUFBLEVBVUEsT0FOQVAsR0FBQUUsR0FBQU0sS0FBQUgsRUFBQUQsUUFBQUMsSUFBQUQsUUFBQUgsR0FHQUksRUFBQUUsUUFBQSxFQUdBRixFQUFBRCxRQXZCQSxHQUFBRCxLQXFDQSxPQVRBRixHQUFBUSxFQUFBVCxFQUdBQyxFQUFBUyxFQUFBUCxFQUdBRixFQUFBVSxFQUFBLEdBR0FWLEVBQUEsS0RNTSxTQUFTSSxFQUFRRCxFQUFTSCxHQUUvQkksRUFBT0QsUUFBVUgsRUFBb0IsSUFLaEMsU0FBU0ksRUFBUUQsR0FF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RUFBUStFLHFCQUFxQlUsS0FHN0J6RixFQUFRMEQsU0FBUytCLEdBQ2pCekYsRUFBUWtFLFdBQVdxQixFQUFPbEQsTUFBT29ELEdBQ2pDekYsRUFBUWlGLHlDQUF5Q1EsR0FDakR6RixFQUFRK0UscUJBQXFCVSxLQVNuQzFELGNBQWUsU0FBU3VELEdBQ3RCQSxFQUFNSSxnQkFDTixJQUFJRCxHQUFhMUYsRUFBRXVGLEVBQU1FLFFBQVFkLFFBQVEsYUFDckNlLEdBQVdULFNBQVMsUUFFdEJoRixFQUFRbUUsU0FBU3NCLEdBR2pCekYsRUFBUTBELFNBQVMrQixJQVFyQnpCLFlBQWEsU0FBU3NCLEdBQ3BCQSxFQUFNSyxpQkFDTixJQUFJQyxHQUFRN0YsRUFBRXVGLEVBQU1FLFFBQ2hCQyxFQUFhRyxFQUFNbEIsUUFBUSxhQUM1QmtCLEdBQU1aLFNBQVMscUJBRWJZLEVBQU1aLFNBQVMsK0JBRWhCUyxFQUFXaEQsS0FBSyxxQkFBcUJKLElBQUl1RCxFQUFNQyxRQUMvQzdGLEVBQVFtRSxTQUFTc0IsS0FHakJILEVBQU1LLGtCQUNIQyxFQUFNWixTQUFTLFNBRWhCWSxFQUFNeEQsV0FBV2dDLFFBQVNxQixFQUFXOUUsS0FBSyxhQUMxQzRELFdBQVcsV0FDVHFCLEVBQU10QixZQUFZLFNBQ2pCLE9BR0hzQixFQUFNeEQsV0FBVzJCLFVBQVcwQixFQUFXOUUsS0FBSyxhQUM1Q2lGLEVBQU1oRixTQUFTLFlBVXZCSSxnQkFBaUIsU0FBU3NFLEdBQzhCLElBQWxEdkYsRUFBRSxtQkFBbUIrRixJQUFJUixFQUFNRSxRQUFRWCxRQUN6QzdFLEVBQVFtRSxTQUFVcEUsRUFBRSxxQkFLMUJBLEdBQUVnRyxHQUFHQyxVQUFZLFNBQVNDLEdBQ3hCLE1BQU9qRyxHQUFRQyxLQUFLaUcsTUFBTS9GLEtBQU1nRyxhQUVqQ0MiLCJmaWxlIjoianF1ZXJ5LmNvbWJvdHJlZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXBcbi8qKioqKiovIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbi8qKioqKiovIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbi8qKioqKiovIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbi8qKioqKiovIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuLyoqKioqKi8gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbi8qKioqKiovIFx0XHRcdGV4cG9ydHM6IHt9LFxuLyoqKioqKi8gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuLyoqKioqKi8gXHRcdFx0bG9hZGVkOiBmYWxzZVxuLyoqKioqKi8gXHRcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuLyoqKioqKi8gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4vKioqKioqLyBcdFx0bW9kdWxlLmxvYWRlZCA9IHRydWU7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4vKioqKioqLyBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuLyoqKioqKi8gXHR9XG4vKioqKioqL1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vKioqKioqLyBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuLyoqKioqKi8gfSlcbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vKioqKioqLyAoW1xuLyogMCAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0bW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpO1xuXG5cbi8qKiovIH0sXG4vKiAxICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHQoZnVuY3Rpb24gKCQpIHtcblx0ICB2YXIgbWV0aG9kcyA9IHtcblx0ICAgIC8vINCY0L3QuNGG0LjQsNC70LjQt9Cw0YbQuNGPINC/0LvQsNCz0LjQvdCwXG5cdCAgICBpbml0OiBmdW5jdGlvbiBpbml0KHBhcmFtcykge1xuXHQgICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAvLyDQpNC+0YDQvNC40YDQvtCy0LDQvdC40LUg0L3QsNGB0YLRgNC+0LXQuiDQv9C70LDQs9C40L3QsCAoJ9GB0LrQu9C10LjQstCw0L3QuNC1JyDQstC90YPRgtGA0LXQvdC90LjRhSDQuCDQstC90LXRiNC90LjRhSDQvdCw0YHRgtGA0L7QtdC6KVxuXHQgICAgICAgIHZhciBjb25maWcgPSB7IHNsaWRlRHVyOiA0MDAgfTtcblx0ICAgICAgICB2YXIgb3B0aW9ucyA9ICQuZXh0ZW5kKHt9LCBjb25maWcsIHBhcmFtcyk7XG5cdFxuXHQgICAgICAgIC8vINCh0LLRj9C30YvQstCw0L3QuNC1INC90LDRgdGC0YDQvtC10Log0YEg0LjRhSDQstC70LDQtNC10LvRjNGG0LXQvCAtINGB0L7QvtGC0LLQtdGC0YHRgtCy0YPRjtGJ0LXQvCBET00t0Y3Qu9C10LzQtdC90YLQvtC8XG5cdCAgICAgICAgdmFyICR0aGlzID0gJCh0aGlzKTtcblx0ICAgICAgICBmb3IgKHZhciBrZXkgaW4gb3B0aW9ucykge1xuXHQgICAgICAgICAgJHRoaXMuZGF0YShrZXksIG9wdGlvbnNba2V5XSk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICAvLyDQntGC0YDQuNGB0L7QstC60LAg0L/QvtC70Y8g0L/QvtC40YHQutCwINC4INC40LrQvtC90LrQuCDRgNCw0YHQutGA0YvRgtC40Y8g0YHQv9C40YHQutCwINCy0LDRgNC40LDQvdGC0L7QslxuXHQgICAgICAgICQoJHRoaXMuZGF0YSgnZWxlbWVudCcpKS5hZGRDbGFzcygnY29tYm90cmVlJyk7XG5cdCAgICAgICAgbWV0aG9kcy5yZW5kZXJGaWVsZCgkdGhpcyk7XG5cdFxuXHQgICAgICAgIC8vINCd0LDQstC10YjQuNCy0LDQvdC40LUg0L7QsdGA0LDQsdC+0YLRh9C40LrQvtCyINGB0L7QsdGL0YLQuNC5XG5cdCAgICAgICAgJChkb2N1bWVudCkuYmluZCgnbW91c2V1cCcsIG1ldGhvZHMub25XaW5kb3dNb3VzZVVwKTtcblx0XG5cdCAgICAgICAgLy8g0KHQvtC30LTQsNC90LjQtSDQutCw0YHRgtC+0LzQvdC+0LPQviBjc3Mt0YHQtdC70LXQutGC0L7RgNCwLCDQutC+0YLQvtGA0YvQuSDQsdGD0LTQtdGCINC40YHQv9C+0LvRjNC30L7QstCw0YLRjNGB0Y8g0LTQu9GPINC/0L7QuNGB0LrQsCDQv9C+INGB0L/QuNGB0LrRg1xuXHQgICAgICAgICQuZXh0ZW5kKCQuZXhwclsnOiddLCB7XG5cdCAgICAgICAgICBjb250YWluc0lOOiBmdW5jdGlvbiBjb250YWluc0lOKGVsZW0sIGksIG1hdGNoKSB7XG5cdCAgICAgICAgICAgIHJldHVybiAoZWxlbS5pbm5lclRleHQgfHwgJycpLnRvTG93ZXJDYXNlKCkuaW5kZXhPZigobWF0Y2hbM10gfHwgJycpLnRvTG93ZXJDYXNlKCkpID49IDA7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfSk7XG5cdCAgICAgIH0pO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqINCe0YLRgNC40YHQvtCy0LrQsCDQv9C+0LvRjyDQstCy0L7QtNCwXG5cdCAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1lbnQgRE9NLdGN0LvQtdC80LXQvdGCINGN0LvQtdC80LXQvdGC0LAsINC00LvRjyDQutC+0YLQvtGA0L7Qs9C+INCy0YvQt9GL0LLQsNC10YLRgdGPINC/0LvQsNCz0LjQvVxuXHQgICAgICovXG5cdCAgICByZW5kZXJGaWVsZDogZnVuY3Rpb24gcmVuZGVyRmllbGQoZWxlbWVudCkge1xuXHQgICAgICAvLyDQldGB0LvQuCDQvdCw0LfQstCw0L3QuNC1INC/0L7Qu9GPINC30LDQtNCw0L3Qviwg0YLQviDQvtGC0YDQuNGB0L7QstGD0LXRgtGB0Y8g0YHQvtC+0YLQstC10YLRgdGC0LLRg9GO0YnQuNC5INGN0LvQtdC80LXQvdGCXG5cdCAgICAgIGlmIChlbGVtZW50LmRhdGEoJ2xhYmVsJykpIHtcblx0ICAgICAgICAkKCc8bGFiZWwgY2xhc3M9XCJjb21ib3RyZWVfX2xhYmVsXCIgZm9yPVwiY29tYm90cmVlX19zZWFyY2hcIj4nICsgZWxlbWVudC5kYXRhKCdsYWJlbCcpICsgJzwvbGFiZWw+JykuYXBwZW5kVG8oJChlbGVtZW50LmRhdGEoJ2VsZW1lbnQnKSkpO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICAvLyDQmtC+0L3RgtC10LnQvdC10YAg0LTQu9GPINC/0L7Qu9GPINCy0LLQvtC00LAg0Lgg0LrQvdC+0L/QutC4INGA0LDRgdC60YDRi9GC0LjRjyDRgdC/0LjRgdC60LAg0LLQsNGA0LjQsNC90YLQvtCyXG5cdCAgICAgIHZhciBpbnB1dENvbnRhaW5lciA9ICQoJzxkaXYgY2xhc3M9XCJjb21ib3RyZWVfX2ZpZWxkXCI+PC9kaXY+JykuYXBwZW5kVG8oJChlbGVtZW50LmRhdGEoJ2VsZW1lbnQnKSkpO1xuXHQgICAgICBpZiAoIWVsZW1lbnQuZGF0YSgnbGFiZWwnKSkge1xuXHQgICAgICAgIGlucHV0Q29udGFpbmVyLmFkZENsYXNzKCd3aXRob3V0LWxhYmVsJyk7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIC8vINCf0L7Qu9C1INCy0LLQvtC00LBcblx0ICAgICAgdmFyIHBsYWNlaG9sZGVyID0gZWxlbWVudC5kYXRhKCdwbGFjZWhvbGRlcicpIHx8ICcnO1xuXHQgICAgICB2YXIgaW5wdXQgPSAkKCc8aW5wdXQgaWQ9XCJjb21ib3RyZWVfX2lucHV0XCIgY2xhc3M9XCJjb21ib3RyZWVfX2lucHV0XCIgdHlwZT1cInNlYXJjaFwiIHBsYWNlaG9sZGVyPVwiJyArIHBsYWNlaG9sZGVyICsgJ1wiPicpLmFwcGVuZFRvKGlucHV0Q29udGFpbmVyKS5iaW5kKCdrZXl1cCcsIG1ldGhvZHMub25JbnB1dENoYW5nZSk7XG5cdFxuXHQgICAgICAvLyDQmtC90L7Qv9C60LAg0L7RgtC60YDRi9GC0LjRjyDRgdC/0LjRgdC60LAg0LLQsNGA0LjQsNC90YLQvtCyXG5cdCAgICAgICQoJzxidXR0b24gY2xhc3M9XCJjb21ib3RyZWVfX2J0blwiIHR5cGU9XCJidXR0b25cIj4nKS5hcHBlbmRUbyhpbnB1dENvbnRhaW5lcikuYmluZCgnY2xpY2snLCBtZXRob2RzLm9uU2VsZWN0Q2xpY2spO1xuXHRcblx0ICAgICAgLy8g0JrQvtC90YLQtdC50L3QtdGAINC00LvRjyDRgdC/0LjRgdC60LAg0LLQsNGA0LjQsNC90YLQvtCyXG5cdCAgICAgIHZhciBsaXN0TWF4SGVpZ2h0ID0gZWxlbWVudC5kYXRhKCdsaXN0SGVpZ2h0JykgfHwgJzI0MCc7XG5cdCAgICAgIHZhciB3cmFwcGVyID0gJCgnPGRpdiBjbGFzcz1cImNvbWJvdHJlZV9fbGlzdC13cmFwcGVyXCI+PC9kaXY+JykuYXBwZW5kVG8oJChlbGVtZW50LmRhdGEoJ2VsZW1lbnQnKSkpO1xuXHQgICAgICB3cmFwcGVyLmNzcygnbWF4LWhlaWdodCcsIGxpc3RNYXhIZWlnaHQgKyAncHgnKTtcblx0XG5cdCAgICAgIC8vINCf0YDQvtGB0YLQsNCy0LvQtdC90LjQtSDQt9C90LDRh9C10L3QuNGPINC/0L4g0YPQvNC+0LvRh9Cw0L3QuNGOXG5cdCAgICAgIGlmIChlbGVtZW50LmRhdGEoJ3ZhbHVlJykpIHtcblx0ICAgICAgICB2YXIgZGVmYXVsdFZhbHVlID0gbWV0aG9kcy5maW5kRGVmYXVsdEl0ZW0oZWxlbWVudC5kYXRhKCdkYXRhJykuY2hpbGRyZW4sIGVsZW1lbnQuZGF0YSgndmFsdWUnKSk7XG5cdCAgICAgICAgaW5wdXQudmFsKGRlZmF1bHRWYWx1ZS5uYW1lKTtcblx0ICAgICAgfVxuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqINCe0YLRgNC40YHQvtCy0LrQsCDRgdC+0LTQtdGA0LbQuNC80L7Qs9C+INCy0YvQv9Cw0LTQsNGO0YnQtdCz0L4g0YHQv9C40YHQutCwXG5cdCAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1lbnQgRE9NLdGN0LvQtdC80LXQvdGCINGN0LvQtdC80LXQvdGC0LAsINC00LvRjyDQutC+0YLQvtGA0L7Qs9C+INCy0YvQt9GL0LLQsNC10YLRgdGPINC/0LvQsNCz0LjQvVxuXHQgICAgICovXG5cdCAgICByZW5kZXJMaXN0OiBmdW5jdGlvbiByZW5kZXJMaXN0KGVsZW1lbnQpIHtcblx0ICAgICAgbWV0aG9kcy5yZW5kZXJOb2RlcyhlbGVtZW50LmRhdGEoJ2RhdGEnKS5jaGlsZHJlbiwgZWxlbWVudC5maW5kKCcuY29tYm90cmVlX19saXN0LXdyYXBwZXInKSk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICog0KDQtdC60YPRgNGB0LjQstC90LDRjyDRhNGD0L3QutGG0LjRjywg0YTQvtGA0LzQuNGA0YPRjtGJ0LDRjyDQuCDQvtGC0YDQuNGB0L7QstGD0Y7RidCw0Y8g0YHQvtC00LXRgNC20LjQvNC+0LUg0LLRi9C/0LDQtNCw0Y7RidC10LPQviDRgdC/0LjRgdC60LBcblx0ICAgICAqIEBwYXJhbSB7QXJyYXl9ICAgY2hpbGRyZW5EYXRhT2JqINCY0L3RhNC+0YDQvNCw0YbQuNGPINC+INCy0LDRgNC40LDQvdGC0LDRhSDRgdC/0LjRgdC60LBcblx0ICAgICAqIEBwYXJhbSB7RWxlbWVudH0gcGFyZW50RWxlbWVudCAgIERPTS3RjdC70LXQvNC10L3RgiDRgNC+0LTQuNGC0LXQu9GPINCy0LDRgNC40LDQvdGC0LAg0YHQv9C40YHQutCwXG5cdCAgICAgKi9cblx0ICAgIHJlbmRlck5vZGVzOiBmdW5jdGlvbiByZW5kZXJOb2RlcyhjaGlsZHJlbkRhdGFPYmosIHBhcmVudEVsZW1lbnQpIHtcblx0ICAgICAgaWYgKGNoaWxkcmVuRGF0YU9iaikge1xuXHQgICAgICAgIChmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAvLyDQntGC0YDQuNGB0L7QstC60LAg0LrQvtC90YLQtdC50L3QtdGA0LAg0LTQu9GPINCy0LDRgNC40LDQvdGC0L7QsiDRgdC/0LjRgdC60LBcblx0ICAgICAgICAgIHZhciBjaGlsZENvbnRhaW5lciA9ICQoJzx1bCBjbGFzcz1cImNvbWJvdHJlZV9fbGlzdFwiPjwvdWw+Jyk7XG5cdCAgICAgICAgICBjaGlsZENvbnRhaW5lci5hcHBlbmRUbyhwYXJlbnRFbGVtZW50KTtcblx0ICAgICAgICAgIC8vINCh0L7RgNGC0LjRgNC+0LLQutCwINCy0LDRgNC40LDQvdGC0L7QsiDRgdC/0LjRgdC60LBcblx0ICAgICAgICAgIGNoaWxkcmVuRGF0YU9iai5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XG5cdCAgICAgICAgICAgIHZhciBjb21wQSA9IGEubmFtZS50b1VwcGVyQ2FzZSgpO1xuXHQgICAgICAgICAgICB2YXIgY29tcEIgPSBiLm5hbWUudG9VcHBlckNhc2UoKTtcblx0ICAgICAgICAgICAgcmV0dXJuIGNvbXBBIDwgY29tcEIgPyAtMSA6IGNvbXBBID4gY29tcEIgPyAxIDogMDtcblx0ICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgLy8g0J7RgtGA0LjRgdC+0LLQutCwINCy0LDRgNC40LDQvdGC0L7QsiDRgdC/0LjRgdC60LBcblx0ICAgICAgICAgIGNoaWxkcmVuRGF0YU9iai5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZCkge1xuXHQgICAgICAgICAgICBwYXJlbnRFbGVtZW50ID0gbWV0aG9kcy5yZW5kZXJJdGVtKGNoaWxkLm5hbWUsIGNoaWxkQ29udGFpbmVyLCAhY2hpbGQuY2hpbGRyZW4pO1xuXHQgICAgICAgICAgICBtZXRob2RzLnJlbmRlck5vZGVzKGNoaWxkLmNoaWxkcmVuLCBwYXJlbnRFbGVtZW50KTtcblx0ICAgICAgICAgIH0pO1xuXHQgICAgICAgIH0pKCk7XG5cdCAgICAgIH1cblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiDQntGC0YDQuNGB0L7QstC60LAg0Y3Qu9C10LzQtdC90YLQsCDRgdC/0LjRgdC60LBcblx0ICAgICAqIEBwYXJhbSAge1N0cmluZ30gICBuYW1lICAgICAgICDQndCw0LfQstCw0L3QuNC1INGN0LvQtdC80LXQvdGC0LBcblx0ICAgICAqIEBwYXJhbSAge0VsZW1lbnR9ICBwYXJlbnQgICAgICBET00t0Y3Qu9C10LzQtdC90YIg0YDQvtC00LjRgtC10LvRjyDRjdC70LXQvNC10L3RgtCwINGB0L/QuNGB0LrQsFxuXHQgICAgICogQHBhcmFtICB7Qm9vbGVhbn0gIGlzTGFzdExldmVsINCf0YDQuNC30L3QsNC6INGC0L7Qs9C+LCDRh9GC0L4g0Y3Qu9C10LzQtdC90YIg0Y/QstC70Y/QtdGC0YHRjyDQvdC40LbQvdC40Lwg0YPRgNC+0LLQvdC10Lwg0LIg0LjQtdGA0LDRgNGF0LjQuCDRgdC/0LjRgdC60LBcblx0ICAgICAqIEByZXR1cm4ge0VsZW1lbnR9ICBpdGVtRWxlbWVudCBET00t0Y3Qu9C10LzQtdC90YIg0LLQsNGA0LjQsNC90YLQsCDRgdC/0LjRgdC60LBcblx0ICAgICAqL1xuXHQgICAgcmVuZGVySXRlbTogZnVuY3Rpb24gcmVuZGVySXRlbShuYW1lLCBwYXJlbnQsIGlzTGFzdExldmVsKSB7XG5cdCAgICAgIHZhciBsYXN0TGV2ZWxDbGFzcyA9IGlzTGFzdExldmVsID8gJ2NvbWJvdHJlZV9faXRlbV9sYXN0LWxldmVsJyA6ICcnO1xuXHQgICAgICB2YXIgaXRlbUVsZW1lbnQgPSAkKCc8bGkgY2xhc3M9XCJjb21ib3RyZWVfX2l0ZW0gJyArIGxhc3RMZXZlbENsYXNzICsgJ1wiPicgKyBuYW1lICsgJzwvbGk+Jyk7XG5cdCAgICAgIGl0ZW1FbGVtZW50LmFwcGVuZFRvKHBhcmVudCk7XG5cdCAgICAgIHJldHVybiBpdGVtRWxlbWVudDtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiDQoNCw0YHQutGA0YvRgtC40LUg0LLRi9C/0LDQtNCw0Y7RidC10LPQviDRgdC/0LjRgdC60LBcblx0ICAgICAqIEBwYXJhbSB7RWxlbWVudH0gZWxlbWVudCBET00t0Y3Qu9C10LzQtdC90YIg0Y3Qu9C10LzQtdC90YLQsCwg0LTQu9GPINC60L7RgtC+0YDQvtCz0L4g0LLRi9C30YvQstCw0LXRgtGB0Y8g0L/Qu9Cw0LPQuNC9XG5cdCAgICAgKi9cblx0ICAgIHNob3dMaXN0OiBmdW5jdGlvbiBzaG93TGlzdChlbGVtZW50KSB7XG5cdCAgICAgIC8vINCS0YvRh9C40YHQu9C10L3QuNC1INC90LjQttC90LXQuSDQv9C+0LfQuNGG0LjQuCDRjdC70LXQvNC10L3RgtCwXG5cdCAgICAgIHZhciBsaXN0TWF4SGVpZ2h0ID0gZWxlbWVudC5kYXRhKCdsaXN0SGVpZ2h0JykgfHwgJzI0MCc7XG5cdCAgICAgIHZhciBlbGVtZW50Qm90dG9tUG9zID0gZWxlbWVudC5vZmZzZXQoKS50b3AgKyBlbGVtZW50LmhlaWdodCgpICsgK2xpc3RNYXhIZWlnaHQ7XG5cdFxuXHQgICAgICBpZiAoZWxlbWVudEJvdHRvbVBvcyA8ICQod2luZG93KS5oZWlnaHQoKSkge1xuXHQgICAgICAgIC8vINCV0YHQu9C4INGN0LvQtdC80LXQvdGCINC80L7QttC10YIg0LHRi9GC0Ywg0YDQsNC30LLQtdGA0L3Rg9GCINCy0L3QuNC3ICjQvNC10YHRgtCwINGF0LLQsNGC0LDQtdGCKSwg0YLQviDQvtC9INGA0LDQt9Cy0L7RgNCw0YfQuNCy0LDQtdGC0YHRjyDQstC90LjQt1xuXHQgICAgICAgIGVsZW1lbnQuZmluZCgnLmNvbWJvdHJlZV9fbGlzdC13cmFwcGVyJykuc2xpZGVEb3duKGVsZW1lbnQuZGF0YSgnc2xpZGVEdXInKSkuYmluZCgnY2xpY2snLCBtZXRob2RzLm9uSXRlbUNsaWNrKTtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAvLyDQldGB0LvQuCDQvNC10YHRgtCwINC00LvRjyDRgNCw0YHQutGA0YvRgtC40Y8g0Y3Qu9C10LzQtdC90YLQsCDQstC90LjQtyDQvdC10LTQvtGB0YLQsNGC0L7Rh9C90L4sINGC0L4g0L7QvSDRgNCw0YHQutGA0YvQstCw0LXRgtGB0Y8g0LLQstC10YDRhVxuXHQgICAgICAgIGVsZW1lbnQuZmluZCgnLmNvbWJvdHJlZV9fbGlzdC13cmFwcGVyJykuYWRkQ2xhc3MoJ29wZW5Ub1RvcCcpLnNsaWRlRG93bihlbGVtZW50LmRhdGEoJ3NsaWRlRHVyJykpLmJpbmQoJ2NsaWNrJywgbWV0aG9kcy5vbkl0ZW1DbGljayk7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIC8vINCe0YLRgNC40YHQvtCy0LrQsCDRgdC/0LjRgdC60LAg0LLQsNGA0LjQsNC90YLQvtCyXG5cdCAgICAgIG1ldGhvZHMucmVuZGVyTGlzdChlbGVtZW50KTtcblx0XG5cdCAgICAgIC8vINCV0YHQu9C4INC/0L7Qu9C1INCy0LLQvtC00LAg0LfQsNC/0L7Qu9C90LXQvdC+LCDRgtC+INGB0L7QvtGC0LLQtdGC0YHRgtCy0YPRjtGJ0LXQtSDQt9C90LDRh9C10L3QuNC1INC/0L7QtNGB0LLQtdGH0LjQstCw0LXRgtGB0Y8g0LIg0YHQv9C40YHQutC1INCy0LDRgNC40LDQvdGC0L7QslxuXHQgICAgICB2YXIgaW5wdXRWYWx1ZSA9IGVsZW1lbnQuZmluZCgnLmNvbWJvdHJlZV9faW5wdXQnKS52YWwoKTtcblx0ICAgICAgaWYgKGlucHV0VmFsdWUgIT09ICcnKSB7XG5cdCAgICAgICAgbWV0aG9kcy5zZWFyY2hJdGVtKGlucHV0VmFsdWUsIGVsZW1lbnQpO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICAvLyDQntGC0LrRgNGL0YLQuNC1INGA0LDRgdC60YDRi9Cy0LDRjtGJ0LXQs9C+0YHRjyDRgdC/0LjRgdC60LBcblx0ICAgICAgZWxlbWVudC5hZGRDbGFzcygnb3BlbicpO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqINCh0LLQvtGA0LDRh9C40LLQsNC90LjQtSDQstGL0L/QsNC00LDRjtGJ0LXQs9C+INGB0L/QuNGB0LrQsFxuXHQgICAgICogQHBhcmFtIHtFbGVtZW50fSBlbGVtZW50IERPTS3RjdC70LXQvNC10L3RgiDRjdC70LXQvNC10L3RgtCwLCDQtNC70Y8g0LrQvtGC0L7RgNC+0LPQviDQstGL0LfRi9Cy0LDQtdGC0YHRjyDQv9C70LDQs9C40L1cblx0ICAgICAqL1xuXHQgICAgaGlkZUxpc3Q6IGZ1bmN0aW9uIGhpZGVMaXN0KGVsZW1lbnQpIHtcblx0ICAgICAgZWxlbWVudC5maW5kKCcuY29tYm90cmVlX19saXN0LXdyYXBwZXInKS5zbGlkZVVwKGVsZW1lbnQuZGF0YSgnc2xpZGVEdXInKSkudW5iaW5kKCdjbGljaycsIG1ldGhvZHMub25JdGVtQ2xpY2spO1xuXHQgICAgICBlbGVtZW50LmZpbmQoJy5jb21ib3RyZWVfX2xpc3Qtd3JhcHBlcicpLmNoaWxkcmVuKCkucmVtb3ZlQ2xhc3MoJ29wZW4nKS5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG5cdFxuXHQgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBlbGVtZW50LnJlbW92ZUNsYXNzKCdvcGVuJyk7XG5cdCAgICAgICAgZWxlbWVudC5maW5kKCcuY29tYm90cmVlX19saXN0LXdyYXBwZXInKS5yZW1vdmVDbGFzcygnb3BlblRvVG9wJykuY2hpbGRyZW4oKS5yZW1vdmUoKTtcblx0ICAgICAgfSwgNTUwKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAqINCf0L7QuNGB0Log0LIg0YHQv9C40YHQutC1INCy0LDRgNC40LDQvdGC0L7Qsiwg0YPQtNC+0LLQu9C10YLQstC+0YDRj9GO0YnQuNC8INCy0LLQtdC00LXQvdC90YvQvCDRg9GB0LvQvtCy0LjRj9C8XG5cdCAgICAqIEBwYXJhbSB7U3RyaW5nfSAgc2VhcmNoQ29uZGl0aW9uINCj0YHQu9C+0LLQuNC1INC/0L7QuNGB0LrQsFxuXHQgICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1lbnQgRE9NLdGN0LvQtdC80LXQvdGCINGN0LvQtdC80LXQvdGC0LAsINC00LvRjyDQutC+0YLQvtGA0L7Qs9C+INCy0YvQt9GL0LLQsNC10YLRgdGPINC/0LvQsNCz0LjQvVxuXHQgICAgKi9cblx0ICAgIHNlYXJjaEl0ZW06IGZ1bmN0aW9uIHNlYXJjaEl0ZW0oc2VhcmNoQ29uZGl0aW9uLCBlbGVtZW50KSB7XG5cdCAgICAgIC8vINCf0L7QuNGB0Log0LIg0YHQv9C40YHQutC1INCy0LDRgNC40LDQvdGC0L7Qsiwg0YPQtNC+0LLQu9C10YLQstC+0YDRj9GO0YnQuNGFINCy0LLQtdC00LXQvdC90YvQvCDRg9GB0LvQvtCy0LjRj9C8XG5cdCAgICAgIGVsZW1lbnQuZmluZCgnLmNvbWJvdHJlZV9faXRlbV9sYXN0LWxldmVsOmNvbnRhaW5zSU4oXCInICsgc2VhcmNoQ29uZGl0aW9uICsgJ1wiKScpLmFkZENsYXNzKCdzZWFyY2gtcmVzdWx0Jyk7XG5cdFxuXHQgICAgICAvLyDQoNCw0YHQutGA0YvRgtC40LUg0LLRgdC10YUg0YDQvtC00LjRgtC10LvQtdC5INC00LvRjyDQstCw0YDQuNCw0L3RgtC+0LIsINGD0LTQvtCy0LvQtdGC0LLQvtGA0Y/RjtGJ0LjRhSDRg9GB0LvQvtCy0LjRj9C8INC/0L7QuNGB0LrQsFxuXHQgICAgICBlbGVtZW50LmZpbmQoJy5zZWFyY2gtcmVzdWx0JykuZWFjaChmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgdmFyIGFsbFBhcmVudHNJdGVtID0gJCh0aGlzKS5wYXJlbnRzKCcuY29tYm90cmVlX19pdGVtJyk7XG5cdCAgICAgICAgYWxsUGFyZW50c0l0ZW0uZWFjaChmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAkKHRoaXMpLmFkZENsYXNzKCdvcGVuJyk7XG5cdCAgICAgICAgfSk7XG5cdFxuXHQgICAgICAgIHZhciBhbGxQYXJlbnRzTGlzdCA9ICQodGhpcykucGFyZW50cygnLmNvbWJvdHJlZV9fbGlzdCcpO1xuXHQgICAgICAgIGFsbFBhcmVudHNMaXN0LmVhY2goZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgJCh0aGlzKS5hZGRDbGFzcygnb3BlbicpO1xuXHQgICAgICAgIH0pO1xuXHQgICAgICB9KTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiDQn9C+0LjRgdC6INC30L3QsNGH0LXQvdC40Y8g0L/QviDRg9C80L7Qu9GH0LDQvdC40Y5cblx0ICAgICAqIEBwYXJhbSAge0FycmF5fSAgY2hpbGRyZW5EYXRhICAg0JjQvdGE0L7RgNC80LDRhtC40Y8g0L4g0LLQsNGA0LjQsNC90YLQsNGFINGB0L/QuNGB0LrQsFxuXHQgICAgICogQHBhcmFtICB7U3RyaW5nfSBkZWZhdWx0VmFsdWVJZCBJRCDQt9C90LDRh9C10L3QuNGPINC/0L4g0YPQvNC+0LvRh9Cw0L3QuNGOXG5cdCAgICAgKiBAcmV0dXJuXG5cdCAgICAgKi9cblx0ICAgIGZpbmREZWZhdWx0SXRlbTogZnVuY3Rpb24gZmluZERlZmF1bHRJdGVtKGNoaWxkcmVuRGF0YSwgZGVmYXVsdFZhbHVlSWQpIHtcblx0ICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGlsZHJlbkRhdGEubGVuZ3RoOyBpKyspIHtcblx0ICAgICAgICBpZiAoY2hpbGRyZW5EYXRhW2ldLmlkID09PSBkZWZhdWx0VmFsdWVJZCkge1xuXHQgICAgICAgICAgcmV0dXJuIGNoaWxkcmVuRGF0YVtpXTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIGlmIChjaGlsZHJlbkRhdGFbaV0uY2hpbGRyZW4pIHtcblx0ICAgICAgICAgIHZhciByZXMgPSBtZXRob2RzLmZpbmREZWZhdWx0SXRlbShjaGlsZHJlbkRhdGFbaV0uY2hpbGRyZW4sIGRlZmF1bHRWYWx1ZUlkKTtcblx0ICAgICAgICAgIGlmIChyZXMpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIHJlcztcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIHJldHVybiBudWxsO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqINCe0YLQvtCx0YDQsNC20LXQvdC40LUg0YHQvtC+0LHRidC10L3QuNGPINC+0LEg0L7RgtGB0YPRgtGB0YLQstC40Lgg0LLQsNGA0LjQsNC90YLQvtCyLCDRg9C00L7QstC70LXRgtCy0L7RgNGP0Y7RidC40YUg0YPRgdC70L7QstC40Y/QvCDQv9C+0LjRgdC60LBcblx0ICAgICAqIEBwYXJhbSB7RWxlbWVudH0gZWxlbWVudCBET00t0Y3Qu9C10LzQtdC90YIg0Y3Qu9C10LzQtdC90YLQsCwg0LTQu9GPINC60L7RgtC+0YDQvtCz0L4g0LLRi9C30YvQstCw0LXRgtGB0Y8g0L/Qu9Cw0LPQuNC9XG5cdCAgICAgKi9cblx0ICAgIHNob3dMaXN0Tm9SZXN1bHRUZXh0OiBmdW5jdGlvbiBzaG93TGlzdE5vUmVzdWx0VGV4dChlbGVtZW50KSB7XG5cdCAgICAgIGlmIChlbGVtZW50LmZpbmQoJy5jb21ib3RyZWVfX2xpc3Qtd3JhcHBlcicpLmNoaWxkcmVuKCkuaGFzQ2xhc3MoJ2hpZGRlbicpICYmICFlbGVtZW50LmZpbmQoJy5jb21ib3RyZWVfX3NlYXJjaF9uby1yZXN1bHQnKS5sZW5ndGgpIHtcblx0ICAgICAgICAkKCc8cCBjbGFzcz1cImNvbWJvdHJlZV9fc2VhcmNoX25vLXJlc3VsdFwiPtCd0LjRh9C10LPQviDQvdC1INC90LDQudC00LXQvdC+PC9wPicpLmFwcGVuZFRvKGVsZW1lbnQuZmluZCgnLmNvbWJvdHJlZV9fbGlzdC13cmFwcGVyJykpO1xuXHQgICAgICB9XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICog0KHQutGA0YvRgtC40LUg0LLQsNGA0LjQsNC90YLQvtCyLCDQutC+0YLQvtGA0YvQtSDRg9GB0LvQvtCy0LjRj9C8INC90LUg0YPQtNC+0LLQu9C10YLQstC+0YDRj9GO0YIsINCwINGC0LDQutC20LUg0L/Rg9GB0YLRi9GFICfRgNC+0LTQuNGC0LXQu9C10LknXG5cdCAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1lbnQgRE9NLdGN0LvQtdC80LXQvdGCLCDQutC+0YLQvtGA0YvQuSDQvdGD0LbQvdC+INGB0LrRgNGL0YLRjFxuXHQgICAgICovXG5cdCAgICBoaWRlTGlzdE9wdGlvbnNOb3RDb21wbHlTZWFyY2hDb25kaXRpb25zOiBmdW5jdGlvbiBoaWRlTGlzdE9wdGlvbnNOb3RDb21wbHlTZWFyY2hDb25kaXRpb25zKGVsZW1lbnQpIHtcblx0ICAgICAgLy8g0KHQutGA0YvRgtC40LUg0YLQtdGFINCy0LDRgNC40LDQvdGC0L7Qsiwg0LrQvtGC0L7RgNGL0LUg0YPRgdC70L7QstC40Y/QvCDQvdC1INGD0LTQvtCy0LvQtdGC0LLQvtGA0Y/RjtGCXG5cdCAgICAgIGVsZW1lbnQuZmluZCgnLmNvbWJvdHJlZV9faXRlbV9sYXN0LWxldmVsJykuZWFjaChmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgaWYgKCEkKHRoaXMpLmhhc0NsYXNzKCdzZWFyY2gtcmVzdWx0JykpIHtcblx0ICAgICAgICAgICQodGhpcykuYWRkQ2xhc3MoJ2hpZGRlbicpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSk7XG5cdFxuXHQgICAgICAvLyDQodC60YDRi9GC0LjQtSDQv9GD0YHRgtGL0YUg0YDQvtC00LjRgtC10LvQtdC5XG5cdCAgICAgIGVsZW1lbnQuZmluZCgnLmNvbWJvdHJlZV9fbGlzdCcpLmVhY2goZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIG1ldGhvZHMuaGlkZUxpc3RFbXB0eVBhcmVudHMoJCh0aGlzKSk7XG5cdCAgICAgIH0pO1xuXHRcblx0ICAgICAgZWxlbWVudC5maW5kKCcuY29tYm90cmVlX19pdGVtJykubm90KCcuY29tYm90cmVlX19pdGVtX2xhc3QtbGV2ZWwnKS5lYWNoKGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBtZXRob2RzLmhpZGVMaXN0RW1wdHlQYXJlbnRzKCQodGhpcykpO1xuXHQgICAgICB9KTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiDQodC60YDRi9GC0LjQtSDQv9GD0YHRgtGL0YUg0Y3Qu9C10LzQtdC90YLQvtCyINC90LXQutC+0L3QtdGH0L3QvtCz0L4g0YPRgNC+0LLQvdGPXG5cdCAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1lbnQgRE9NLdGN0LvQtdC80LXQvdGCLCDQutC+0YLQvtGA0YvQuSDQvdGD0LbQvdC+INGB0LrRgNGL0YLRjFxuXHQgICAgICovXG5cdCAgICBoaWRlTGlzdEVtcHR5UGFyZW50czogZnVuY3Rpb24gaGlkZUxpc3RFbXB0eVBhcmVudHMoZWxlbWVudCkge1xuXHQgICAgICB2YXIgaGFzU2hvd0xpc3RlZEl0ZW0gPSBmYWxzZTtcblx0ICAgICAgdmFyIGxhc3RMZXZlbCA9IGVsZW1lbnQuZmluZCgnLmNvbWJvdHJlZV9faXRlbV9sYXN0LWxldmVsJyk7XG5cdCAgICAgIGxhc3RMZXZlbC5lYWNoKGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBpZiAoJCh0aGlzKS5oYXNDbGFzcygnc2VhcmNoLXJlc3VsdCcpKSB7XG5cdCAgICAgICAgICBoYXNTaG93TGlzdGVkSXRlbSA9IHRydWU7XG5cdCAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICAgICAgfVxuXHQgICAgICB9KTtcblx0XG5cdCAgICAgIGlmICghaGFzU2hvd0xpc3RlZEl0ZW0pIHtcblx0ICAgICAgICBlbGVtZW50LnJlbW92ZUNsYXNzKCdvcGVuJykuYWRkQ2xhc3MoJ2hpZGRlbicpO1xuXHQgICAgICB9XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICog0KHQsdGA0L7RgSDRgNC10LfRg9C70YzRgtCw0YLQvtCyINC/0L7QuNGB0LrQsFxuXHQgICAgICogQHBhcmFtIHtFbGVtZW50fSBlbGVtZW50IERPTS3RjdC70LXQvNC10L3RgiDRjdC70LXQvNC10L3RgtCwLCDQtNC70Y8g0LrQvtGC0L7RgNC+0LPQviDQstGL0LfRi9Cy0LDQtdGC0YHRjyDQv9C70LDQs9C40L1cblx0ICAgICAqL1xuXHQgICAgcmVzZXRTZWFyY2hSZXN1bHQ6IGZ1bmN0aW9uIHJlc2V0U2VhcmNoUmVzdWx0KGVsZW1lbnQpIHtcblx0ICAgICAgZWxlbWVudC5maW5kKCcuY29tYm90cmVlX19saXN0JykucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuXHQgICAgICBlbGVtZW50LmZpbmQoJy5jb21ib3RyZWVfX2l0ZW0nKS5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG5cdCAgICAgIGVsZW1lbnQuZmluZCgnLmNvbWJvdHJlZV9faXRlbV9sYXN0LWxldmVsJykucmVtb3ZlQ2xhc3MoJ3NlYXJjaC1yZXN1bHQnKTtcblx0ICAgICAgZWxlbWVudC5maW5kKCcuY29tYm90cmVlX19zZWFyY2hfbm8tcmVzdWx0JykucmVtb3ZlKCk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICog0J7QsdGA0LDQsdC+0YLRh9C40Log0YHQvtCx0YvRgtC40Y8g0LjQt9C80LXQvdC10L3QuNGPINC30L3QsNGH0LXQvdC40Y8g0L/QvtC70Y8g0LLQstC+0LTQsFxuXHQgICAgICogQHBhcmFtIHtPYmplY3R9IGV2ZW50XG5cdCAgICAgKi9cblx0ICAgIG9uSW5wdXRDaGFuZ2U6IGZ1bmN0aW9uIG9uSW5wdXRDaGFuZ2UoZXZlbnQpIHtcblx0ICAgICAgdmFyICRpbnB1dCA9ICQoZXZlbnQudGFyZ2V0KTtcblx0ICAgICAgdmFyICRjb21ib3RyZWUgPSAkKGV2ZW50LnRhcmdldCkucGFyZW50cygnLmNvbWJvdHJlZScpO1xuXHQgICAgICBpZiAoJGlucHV0LnZhbCgpLmxlbmd0aCA9PT0gMCkge1xuXHQgICAgICAgIC8vINCj0YHQu9C+0LLQuNC1INC/0L7QuNGB0LrQsCDQvdC1INCy0LLQtdC00LXQvdC+XG5cdCAgICAgICAgaWYgKCRjb21ib3RyZWUuaGFzQ2xhc3MoJ29wZW4nKSkge1xuXHQgICAgICAgICAgbWV0aG9kcy5yZXNldFNlYXJjaFJlc3VsdCgkY29tYm90cmVlKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgLy8g0KPRgdC70L7QstC40LUg0L/QvtC40YHQutCwINCy0LLQtdC00LXQvdC+XG5cdCAgICAgICAgaWYgKCRjb21ib3RyZWUuaGFzQ2xhc3MoJ29wZW4nKSkge1xuXHQgICAgICAgICAgLy8g0KHQv9C40YHQvtC6INCy0LDRgNC40LDQvdGC0L7QsiDRgNCw0YHQutGA0YvRglxuXHQgICAgICAgICAgbWV0aG9kcy5yZXNldFNlYXJjaFJlc3VsdCgkY29tYm90cmVlKTtcblx0ICAgICAgICAgIG1ldGhvZHMuc2VhcmNoSXRlbSgkaW5wdXQudmFsKCksICRjb21ib3RyZWUpO1xuXHQgICAgICAgICAgbWV0aG9kcy5oaWRlTGlzdE9wdGlvbnNOb3RDb21wbHlTZWFyY2hDb25kaXRpb25zKCRjb21ib3RyZWUpO1xuXHQgICAgICAgICAgbWV0aG9kcy5zaG93TGlzdE5vUmVzdWx0VGV4dCgkY29tYm90cmVlKTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgLy8g0KHQv9C40YHQvtC6INCy0LDRgNC40LDQvdGC0L7QsiDRgdCy0LXRgNC90YPRglxuXHQgICAgICAgICAgbWV0aG9kcy5zaG93TGlzdCgkY29tYm90cmVlKTtcblx0ICAgICAgICAgIG1ldGhvZHMuc2VhcmNoSXRlbSgkaW5wdXQudmFsKCksICRjb21ib3RyZWUpO1xuXHQgICAgICAgICAgbWV0aG9kcy5oaWRlTGlzdE9wdGlvbnNOb3RDb21wbHlTZWFyY2hDb25kaXRpb25zKCRjb21ib3RyZWUpO1xuXHQgICAgICAgICAgbWV0aG9kcy5zaG93TGlzdE5vUmVzdWx0VGV4dCgkY29tYm90cmVlKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiDQntCx0YDQsNCx0L7RgtGH0LjQuiDRgdC+0LHRi9GC0LjRjyDQvdCw0LbQsNGC0LjRjyDQvdCwINC60L3QvtC/0LrRgyDRgNCw0YHQutGA0YvRgtC40Y8g0LLRi9C/0LDQtNCw0Y7RidC10LPQviDRgdC/0LjRgdC60LBcblx0ICAgICAqIEBwYXJhbSB7T2JqZWN0fSBldmVudFxuXHQgICAgICovXG5cdCAgICBvblNlbGVjdENsaWNrOiBmdW5jdGlvbiBvblNlbGVjdENsaWNrKGV2ZW50KSB7XG5cdCAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdCAgICAgIHZhciAkY29tYm90cmVlID0gJChldmVudC50YXJnZXQpLnBhcmVudHMoJy5jb21ib3RyZWUnKTtcblx0ICAgICAgaWYgKCRjb21ib3RyZWUuaGFzQ2xhc3MoJ29wZW4nKSkge1xuXHQgICAgICAgIC8vINCh0L/QuNGB0L7QuiDQstCw0YDQuNCw0L3RgtC+0LIg0YDQsNC30LLQtdGA0L3Rg9GCXG5cdCAgICAgICAgbWV0aG9kcy5oaWRlTGlzdCgkY29tYm90cmVlKTtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAvLyDQodC/0LjRgdC+0Log0LLQsNGA0LjQsNC90YLQvtCyINGB0LLQtdGA0L3Rg9GCXG5cdCAgICAgICAgbWV0aG9kcy5zaG93TGlzdCgkY29tYm90cmVlKTtcblx0ICAgICAgfVxuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqINCe0LHRgNCw0LHQvtGC0YfQuNC6INGB0L7QsdGL0YLQuNGPINC90LDQttCw0YLQuNGPINC90LAg0Y3Qu9C10LzQtdC90YIg0YHQv9C40YHQutCwXG5cdCAgICAgKiBAcGFyYW0ge09iamVjdH0gZXZlbnRcblx0ICAgICAqL1xuXHQgICAgb25JdGVtQ2xpY2s6IGZ1bmN0aW9uIG9uSXRlbUNsaWNrKGV2ZW50KSB7XG5cdCAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuXHQgICAgICB2YXIgJGl0ZW0gPSAkKGV2ZW50LnRhcmdldCk7XG5cdCAgICAgIHZhciAkY29tYm90cmVlID0gJGl0ZW0ucGFyZW50cygnLmNvbWJvdHJlZScpO1xuXHQgICAgICBpZiAoJGl0ZW0uaGFzQ2xhc3MoJ2NvbWJvdHJlZV9faXRlbScpKSB7XG5cdCAgICAgICAgLy8g0J3QsNC20LDRgiDRjdC70LXQvNC10L3RgiDRgdC/0LjRgdC60LBcblx0ICAgICAgICBpZiAoJGl0ZW0uaGFzQ2xhc3MoJ2NvbWJvdHJlZV9faXRlbV9sYXN0LWxldmVsJykpIHtcblx0ICAgICAgICAgIC8vINCd0LDQttCw0YIg0Y3Qu9C10LzQtdC90YIg0L/QvtGB0LvQtdC00L3QtdCz0L4g0YPRgNC+0LLQvdGPXG5cdCAgICAgICAgICAkY29tYm90cmVlLmZpbmQoJy5jb21ib3RyZWVfX2lucHV0JykudmFsKCRpdGVtLnRleHQoKSk7XG5cdCAgICAgICAgICBtZXRob2RzLmhpZGVMaXN0KCRjb21ib3RyZWUpO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAvLyDQndCw0LbQsNGCINGN0LvQtdC80LXQvdGCINC90LUg0L/QvtGB0LvQtdC00L3QtdCz0L4g0YPRgNC+0LLQvdGPXG5cdCAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcblx0ICAgICAgICAgIGlmICgkaXRlbS5oYXNDbGFzcygnb3BlbicpKSB7XG5cdCAgICAgICAgICAgIC8vINCt0LvQtdC80LXQvdGCINGA0LDQt9Cy0LXRgNC90YPRglxuXHQgICAgICAgICAgICAkaXRlbS5jaGlsZHJlbigpLnNsaWRlVXAoJGNvbWJvdHJlZS5kYXRhKCdzbGlkZUR1cicpKTtcblx0ICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgICAgJGl0ZW0ucmVtb3ZlQ2xhc3MoJ29wZW4nKTtcblx0ICAgICAgICAgICAgfSwgNDAwKTtcblx0ICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIC8vINCt0LvQtdC80LXQvdGCINGB0LLQtdGA0L3Rg9GCXG5cdCAgICAgICAgICAgICRpdGVtLmNoaWxkcmVuKCkuc2xpZGVEb3duKCRjb21ib3RyZWUuZGF0YSgnc2xpZGVEdXInKSk7XG5cdCAgICAgICAgICAgICRpdGVtLmFkZENsYXNzKCdvcGVuJyk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICog0J7QsdGA0LDQsdC+0YLRh9C40Log0YHQvtCx0YvRgtC40Y8g0YnQtdC70YfQutCwINC80YvRiNGM0Y4g0LIg0LvRjtCx0L7QuSDQvNC10YHRgtC1INGN0LrRgNCw0L3QsCwg0LrRgNC+0LzQtSDQvtCx0LvQsNGB0YLQuCBjb21ib3RyZWVcblx0ICAgICAqIEBwYXJhbSB7T2JqZWN0fSBldmVudFxuXHQgICAgICovXG5cdCAgICBvbldpbmRvd01vdXNlVXA6IGZ1bmN0aW9uIG9uV2luZG93TW91c2VVcChldmVudCkge1xuXHQgICAgICBpZiAoJCgnLmNvbWJvdHJlZS5vcGVuJykuaGFzKGV2ZW50LnRhcmdldCkubGVuZ3RoID09PSAwKSB7XG5cdCAgICAgICAgbWV0aG9kcy5oaWRlTGlzdCgkKCcuY29tYm90cmVlLm9wZW4nKSk7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICB9O1xuXHRcblx0ICAkLmZuLmNvbWJvdHJlZSA9IGZ1bmN0aW9uIChzZXR0aW5ncykge1xuXHQgICAgcmV0dXJuIG1ldGhvZHMuaW5pdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHQgIH07XG5cdH0pKGpRdWVyeSk7XG5cbi8qKiovIH1cbi8qKioqKiovIF0pO1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBqcXVlcnkuY29tYm90cmVlLmpzIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pXG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG5cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGV4cG9ydHM6IHt9LFxuIFx0XHRcdGlkOiBtb2R1bGVJZCxcbiBcdFx0XHRsb2FkZWQ6IGZhbHNlXG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmxvYWRlZCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oMCk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gd2VicGFjay9ib290c3RyYXAgMDRiOWFmZGYyYjgzZDc3MmE4ZWYiLCIoZnVuY3Rpb24oICQgKSB7XG4gIGxldCBtZXRob2RzID0ge1xuICAgIC8vINCY0L3QuNGG0LjQsNC70LjQt9Cw0YbQuNGPINC/0LvQsNCz0LjQvdCwXG4gICAgaW5pdDogZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyDQpNC+0YDQvNC40YDQvtCy0LDQvdC40LUg0L3QsNGB0YLRgNC+0LXQuiDQv9C70LDQs9C40L3QsCAoJ9GB0LrQu9C10LjQstCw0L3QuNC1JyDQstC90YPRgtGA0LXQvdC90LjRhSDQuCDQstC90LXRiNC90LjRhSDQvdCw0YHRgtGA0L7QtdC6KVxuICAgICAgICBsZXQgY29uZmlnID0geyBzbGlkZUR1cjogNDAwIH07XG4gICAgICAgIGxldCBvcHRpb25zID0gJC5leHRlbmQoe30sIGNvbmZpZywgcGFyYW1zKTtcblxuICAgICAgICAvLyDQodCy0Y/Qt9GL0LLQsNC90LjQtSDQvdCw0YHRgtGA0L7QtdC6INGBINC40YUg0LLQu9Cw0LTQtdC70YzRhtC10LwgLSDRgdC+0L7RgtCy0LXRgtGB0YLQstGD0Y7RidC10LwgRE9NLdGN0LvQtdC80LXQvdGC0L7QvFxuICAgICAgICBsZXQgJHRoaXMgPSAkKHRoaXMpO1xuICAgICAgICBmb3IobGV0IGtleSBpbiBvcHRpb25zKSB7XG4gICAgICAgICAgJHRoaXMuZGF0YShrZXksIG9wdGlvbnNba2V5XSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyDQntGC0YDQuNGB0L7QstC60LAg0L/QvtC70Y8g0L/QvtC40YHQutCwINC4INC40LrQvtC90LrQuCDRgNCw0YHQutGA0YvRgtC40Y8g0YHQv9C40YHQutCwINCy0LDRgNC40LDQvdGC0L7QslxuICAgICAgICAkKCAkdGhpcy5kYXRhKCdlbGVtZW50JykgKS5hZGRDbGFzcygnY29tYm90cmVlJyk7XG4gICAgICAgIG1ldGhvZHMucmVuZGVyRmllbGQoJHRoaXMpO1xuXG4gICAgICAgIC8vINCd0LDQstC10YjQuNCy0LDQvdC40LUg0L7QsdGA0LDQsdC+0YLRh9C40LrQvtCyINGB0L7QsdGL0YLQuNC5XG4gICAgICAgICQoZG9jdW1lbnQpLmJpbmQoJ21vdXNldXAnLCBtZXRob2RzLm9uV2luZG93TW91c2VVcCk7XG5cbiAgICAgICAgLy8g0KHQvtC30LTQsNC90LjQtSDQutCw0YHRgtC+0LzQvdC+0LPQviBjc3Mt0YHQtdC70LXQutGC0L7RgNCwLCDQutC+0YLQvtGA0YvQuSDQsdGD0LTQtdGCINC40YHQv9C+0LvRjNC30L7QstCw0YLRjNGB0Y8g0LTQu9GPINC/0L7QuNGB0LrQsCDQv9C+INGB0L/QuNGB0LrRg1xuICAgICAgICAkLmV4dGVuZCgkLmV4cHJbJzonXSwge1xuICAgICAgICAgIGNvbnRhaW5zSU46IGZ1bmN0aW9uKGVsZW0sIGksIG1hdGNoKSB7XG4gICAgICAgICAgICByZXR1cm4gKGVsZW0uaW5uZXJUZXh0IHx8ICcnKS50b0xvd2VyQ2FzZSgpLmluZGV4T2YoKG1hdGNoWzNdIHx8ICcnKS50b0xvd2VyQ2FzZSgpKSA+PSAwO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICog0J7RgtGA0LjRgdC+0LLQutCwINC/0L7Qu9GPINCy0LLQvtC00LBcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1lbnQgRE9NLdGN0LvQtdC80LXQvdGCINGN0LvQtdC80LXQvdGC0LAsINC00LvRjyDQutC+0YLQvtGA0L7Qs9C+INCy0YvQt9GL0LLQsNC10YLRgdGPINC/0LvQsNCz0LjQvVxuICAgICAqL1xuICAgIHJlbmRlckZpZWxkOiBmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgICAvLyDQldGB0LvQuCDQvdCw0LfQstCw0L3QuNC1INC/0L7Qu9GPINC30LDQtNCw0L3Qviwg0YLQviDQvtGC0YDQuNGB0L7QstGD0LXRgtGB0Y8g0YHQvtC+0YLQstC10YLRgdGC0LLRg9GO0YnQuNC5INGN0LvQtdC80LXQvdGCXG4gICAgICBpZiggZWxlbWVudC5kYXRhKCdsYWJlbCcpICkge1xuICAgICAgICAkKCc8bGFiZWwgY2xhc3M9XCJjb21ib3RyZWVfX2xhYmVsXCIgZm9yPVwiY29tYm90cmVlX19zZWFyY2hcIj4nICsgZWxlbWVudC5kYXRhKCdsYWJlbCcpICArICc8L2xhYmVsPicpLmFwcGVuZFRvKCAkKCBlbGVtZW50LmRhdGEoJ2VsZW1lbnQnKSApICk7XG4gICAgICB9XG5cbiAgICAgIC8vINCa0L7QvdGC0LXQudC90LXRgCDQtNC70Y8g0L/QvtC70Y8g0LLQstC+0LTQsCDQuCDQutC90L7Qv9C60Lgg0YDQsNGB0LrRgNGL0YLQuNGPINGB0L/QuNGB0LrQsCDQstCw0YDQuNCw0L3RgtC+0LJcbiAgICAgIGxldCBpbnB1dENvbnRhaW5lciA9ICQoJzxkaXYgY2xhc3M9XCJjb21ib3RyZWVfX2ZpZWxkXCI+PC9kaXY+JykuYXBwZW5kVG8oICQoIGVsZW1lbnQuZGF0YSgnZWxlbWVudCcpICkgKTtcbiAgICAgIGlmKCAhZWxlbWVudC5kYXRhKCdsYWJlbCcpICkge1xuICAgICAgICBpbnB1dENvbnRhaW5lci5hZGRDbGFzcygnd2l0aG91dC1sYWJlbCcpO1xuICAgICAgfVxuXG4gICAgICAvLyDQn9C+0LvQtSDQstCy0L7QtNCwXG4gICAgICBsZXQgcGxhY2Vob2xkZXIgPSBlbGVtZW50LmRhdGEoJ3BsYWNlaG9sZGVyJykgfHwgJyc7XG4gICAgICBsZXQgaW5wdXQgPSAkKCc8aW5wdXQgaWQ9XCJjb21ib3RyZWVfX2lucHV0XCIgY2xhc3M9XCJjb21ib3RyZWVfX2lucHV0XCIgdHlwZT1cInNlYXJjaFwiIHBsYWNlaG9sZGVyPVwiJyArIHBsYWNlaG9sZGVyICsgJ1wiPicpXG4gICAgICAuYXBwZW5kVG8oaW5wdXRDb250YWluZXIpXG4gICAgICAuYmluZCgna2V5dXAnLCBtZXRob2RzLm9uSW5wdXRDaGFuZ2UpO1xuXG4gICAgICAvLyDQmtC90L7Qv9C60LAg0L7RgtC60YDRi9GC0LjRjyDRgdC/0LjRgdC60LAg0LLQsNGA0LjQsNC90YLQvtCyXG4gICAgICAkKCc8YnV0dG9uIGNsYXNzPVwiY29tYm90cmVlX19idG5cIiB0eXBlPVwiYnV0dG9uXCI+JylcbiAgICAgIC5hcHBlbmRUbyhpbnB1dENvbnRhaW5lcilcbiAgICAgIC5iaW5kKCdjbGljaycsIG1ldGhvZHMub25TZWxlY3RDbGljayk7XG5cbiAgICAgIC8vINCa0L7QvdGC0LXQudC90LXRgCDQtNC70Y8g0YHQv9C40YHQutCwINCy0LDRgNC40LDQvdGC0L7QslxuICAgICAgbGV0IGxpc3RNYXhIZWlnaHQgPSBlbGVtZW50LmRhdGEoJ2xpc3RIZWlnaHQnKSB8fCAnMjQwJztcbiAgICAgIGxldCB3cmFwcGVyID0gJCgnPGRpdiBjbGFzcz1cImNvbWJvdHJlZV9fbGlzdC13cmFwcGVyXCI+PC9kaXY+JykuYXBwZW5kVG8oICQoIGVsZW1lbnQuZGF0YSgnZWxlbWVudCcpICkgKTtcbiAgICAgIHdyYXBwZXIuY3NzKCdtYXgtaGVpZ2h0JywgbGlzdE1heEhlaWdodCArICdweCcpO1xuXG4gICAgICAvLyDQn9GA0L7RgdGC0LDQstC70LXQvdC40LUg0LfQvdCw0YfQtdC90LjRjyDQv9C+INGD0LzQvtC70YfQsNC90LjRjlxuICAgICAgaWYoIGVsZW1lbnQuZGF0YSgndmFsdWUnKSApIHtcbiAgICAgICAgbGV0IGRlZmF1bHRWYWx1ZSA9IG1ldGhvZHMuZmluZERlZmF1bHRJdGVtKCBlbGVtZW50LmRhdGEoJ2RhdGEnKS5jaGlsZHJlbiwgZWxlbWVudC5kYXRhKCd2YWx1ZScpICk7XG4gICAgICAgIGlucHV0LnZhbCggZGVmYXVsdFZhbHVlLm5hbWUgKTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICog0J7RgtGA0LjRgdC+0LLQutCwINGB0L7QtNC10YDQttC40LzQvtCz0L4g0LLRi9C/0LDQtNCw0Y7RidC10LPQviDRgdC/0LjRgdC60LBcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1lbnQgRE9NLdGN0LvQtdC80LXQvdGCINGN0LvQtdC80LXQvdGC0LAsINC00LvRjyDQutC+0YLQvtGA0L7Qs9C+INCy0YvQt9GL0LLQsNC10YLRgdGPINC/0LvQsNCz0LjQvVxuICAgICAqL1xuICAgIHJlbmRlckxpc3Q6IGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICAgIG1ldGhvZHMucmVuZGVyTm9kZXMoIGVsZW1lbnQuZGF0YSgnZGF0YScpLmNoaWxkcmVuLCBlbGVtZW50LmZpbmQoJy5jb21ib3RyZWVfX2xpc3Qtd3JhcHBlcicpKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICog0KDQtdC60YPRgNGB0LjQstC90LDRjyDRhNGD0L3QutGG0LjRjywg0YTQvtGA0LzQuNGA0YPRjtGJ0LDRjyDQuCDQvtGC0YDQuNGB0L7QstGD0Y7RidCw0Y8g0YHQvtC00LXRgNC20LjQvNC+0LUg0LLRi9C/0LDQtNCw0Y7RidC10LPQviDRgdC/0LjRgdC60LBcbiAgICAgKiBAcGFyYW0ge0FycmF5fSAgIGNoaWxkcmVuRGF0YU9iaiDQmNC90YTQvtGA0LzQsNGG0LjRjyDQviDQstCw0YDQuNCw0L3RgtCw0YUg0YHQv9C40YHQutCwXG4gICAgICogQHBhcmFtIHtFbGVtZW50fSBwYXJlbnRFbGVtZW50ICAgRE9NLdGN0LvQtdC80LXQvdGCINGA0L7QtNC40YLQtdC70Y8g0LLQsNGA0LjQsNC90YLQsCDRgdC/0LjRgdC60LBcbiAgICAgKi9cbiAgICByZW5kZXJOb2RlczogZnVuY3Rpb24oY2hpbGRyZW5EYXRhT2JqLCBwYXJlbnRFbGVtZW50KSB7XG4gICAgICBpZihjaGlsZHJlbkRhdGFPYmopIHtcbiAgICAgICAgLy8g0J7RgtGA0LjRgdC+0LLQutCwINC60L7QvdGC0LXQudC90LXRgNCwINC00LvRjyDQstCw0YDQuNCw0L3RgtC+0LIg0YHQv9C40YHQutCwXG4gICAgICAgIGxldCBjaGlsZENvbnRhaW5lciA9ICQoJzx1bCBjbGFzcz1cImNvbWJvdHJlZV9fbGlzdFwiPjwvdWw+Jyk7XG4gICAgICAgIGNoaWxkQ29udGFpbmVyLmFwcGVuZFRvKHBhcmVudEVsZW1lbnQpO1xuICAgICAgICAvLyDQodC+0YDRgtC40YDQvtCy0LrQsCDQstCw0YDQuNCw0L3RgtC+0LIg0YHQv9C40YHQutCwXG4gICAgICAgIGNoaWxkcmVuRGF0YU9iai5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcbiAgICAgICAgICBsZXQgY29tcEEgPSBhLm5hbWUudG9VcHBlckNhc2UoKTtcbiAgICAgICAgICBsZXQgY29tcEIgPSBiLm5hbWUudG9VcHBlckNhc2UoKTtcbiAgICAgICAgICByZXR1cm4gKGNvbXBBIDwgY29tcEIpID8gLTEgOiAoY29tcEEgPiBjb21wQikgPyAxIDogMDtcbiAgICAgICAgfSk7XG4gICAgICAgIC8vINCe0YLRgNC40YHQvtCy0LrQsCDQstCw0YDQuNCw0L3RgtC+0LIg0YHQv9C40YHQutCwXG4gICAgICAgIGNoaWxkcmVuRGF0YU9iai5mb3JFYWNoKGZ1bmN0aW9uKGNoaWxkKSB7XG4gICAgICAgICAgcGFyZW50RWxlbWVudCA9IG1ldGhvZHMucmVuZGVySXRlbShjaGlsZC5uYW1lLCBjaGlsZENvbnRhaW5lciwgIWNoaWxkLmNoaWxkcmVuKTtcbiAgICAgICAgICBtZXRob2RzLnJlbmRlck5vZGVzKGNoaWxkLmNoaWxkcmVuLCBwYXJlbnRFbGVtZW50KTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqINCe0YLRgNC40YHQvtCy0LrQsCDRjdC70LXQvNC10L3RgtCwINGB0L/QuNGB0LrQsFxuICAgICAqIEBwYXJhbSAge1N0cmluZ30gICBuYW1lICAgICAgICDQndCw0LfQstCw0L3QuNC1INGN0LvQtdC80LXQvdGC0LBcbiAgICAgKiBAcGFyYW0gIHtFbGVtZW50fSAgcGFyZW50ICAgICAgRE9NLdGN0LvQtdC80LXQvdGCINGA0L7QtNC40YLQtdC70Y8g0Y3Qu9C10LzQtdC90YLQsCDRgdC/0LjRgdC60LBcbiAgICAgKiBAcGFyYW0gIHtCb29sZWFufSAgaXNMYXN0TGV2ZWwg0J/RgNC40LfQvdCw0Log0YLQvtCz0L4sINGH0YLQviDRjdC70LXQvNC10L3RgiDRj9Cy0LvRj9C10YLRgdGPINC90LjQttC90LjQvCDRg9GA0L7QstC90LXQvCDQsiDQuNC10YDQsNGA0YXQuNC4INGB0L/QuNGB0LrQsFxuICAgICAqIEByZXR1cm4ge0VsZW1lbnR9ICBpdGVtRWxlbWVudCBET00t0Y3Qu9C10LzQtdC90YIg0LLQsNGA0LjQsNC90YLQsCDRgdC/0LjRgdC60LBcbiAgICAgKi9cbiAgICByZW5kZXJJdGVtOiBmdW5jdGlvbihuYW1lLCBwYXJlbnQsIGlzTGFzdExldmVsKSB7XG4gICAgICBsZXQgbGFzdExldmVsQ2xhc3MgPSBpc0xhc3RMZXZlbCA/ICdjb21ib3RyZWVfX2l0ZW1fbGFzdC1sZXZlbCcgOiAnJztcbiAgICAgIGxldCBpdGVtRWxlbWVudCA9ICQoJzxsaSBjbGFzcz1cImNvbWJvdHJlZV9faXRlbSAnICsgbGFzdExldmVsQ2xhc3MgKyAnXCI+JyArIG5hbWUgKyAnPC9saT4nICk7XG4gICAgICBpdGVtRWxlbWVudC5hcHBlbmRUbyhwYXJlbnQpO1xuICAgICAgcmV0dXJuIGl0ZW1FbGVtZW50O1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiDQoNCw0YHQutGA0YvRgtC40LUg0LLRi9C/0LDQtNCw0Y7RidC10LPQviDRgdC/0LjRgdC60LBcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1lbnQgRE9NLdGN0LvQtdC80LXQvdGCINGN0LvQtdC80LXQvdGC0LAsINC00LvRjyDQutC+0YLQvtGA0L7Qs9C+INCy0YvQt9GL0LLQsNC10YLRgdGPINC/0LvQsNCz0LjQvVxuICAgICAqL1xuICAgIHNob3dMaXN0OiBmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgICAvLyDQktGL0YfQuNGB0LvQtdC90LjQtSDQvdC40LbQvdC10Lkg0L/QvtC30LjRhtC40Lgg0Y3Qu9C10LzQtdC90YLQsFxuICAgICAgbGV0IGxpc3RNYXhIZWlnaHQgPSBlbGVtZW50LmRhdGEoJ2xpc3RIZWlnaHQnKSB8fCAnMjQwJztcbiAgICAgIGxldCBlbGVtZW50Qm90dG9tUG9zID0gZWxlbWVudC5vZmZzZXQoKS50b3AgKyBlbGVtZW50LmhlaWdodCgpICsgK2xpc3RNYXhIZWlnaHQ7XG5cbiAgICAgIGlmKGVsZW1lbnRCb3R0b21Qb3MgPCAkKHdpbmRvdykuaGVpZ2h0KCkpIHtcbiAgICAgICAgLy8g0JXRgdC70Lgg0Y3Qu9C10LzQtdC90YIg0LzQvtC20LXRgiDQsdGL0YLRjCDRgNCw0LfQstC10YDQvdGD0YIg0LLQvdC40LcgKNC80LXRgdGC0LAg0YXQstCw0YLQsNC10YIpLCDRgtC+INC+0L0g0YDQsNC30LLQvtGA0LDRh9C40LLQsNC10YLRgdGPINCy0L3QuNC3XG4gICAgICAgIGVsZW1lbnQuZmluZCgnLmNvbWJvdHJlZV9fbGlzdC13cmFwcGVyJykuc2xpZGVEb3duKCBlbGVtZW50LmRhdGEoJ3NsaWRlRHVyJykgKS5iaW5kKCdjbGljaycsIG1ldGhvZHMub25JdGVtQ2xpY2spO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8g0JXRgdC70Lgg0LzQtdGB0YLQsCDQtNC70Y8g0YDQsNGB0LrRgNGL0YLQuNGPINGN0LvQtdC80LXQvdGC0LAg0LLQvdC40Lcg0L3QtdC00L7RgdGC0LDRgtC+0YfQvdC+LCDRgtC+INC+0L0g0YDQsNGB0LrRgNGL0LLQsNC10YLRgdGPINCy0LLQtdGA0YVcbiAgICAgICAgZWxlbWVudC5maW5kKCcuY29tYm90cmVlX19saXN0LXdyYXBwZXInKS5hZGRDbGFzcygnb3BlblRvVG9wJykuc2xpZGVEb3duKCBlbGVtZW50LmRhdGEoJ3NsaWRlRHVyJykgKS5iaW5kKCdjbGljaycsIG1ldGhvZHMub25JdGVtQ2xpY2spO1xuICAgICAgfVxuXG4gICAgICAvLyDQntGC0YDQuNGB0L7QstC60LAg0YHQv9C40YHQutCwINCy0LDRgNC40LDQvdGC0L7QslxuICAgICAgbWV0aG9kcy5yZW5kZXJMaXN0KGVsZW1lbnQpO1xuXG4gICAgICAvLyDQldGB0LvQuCDQv9C+0LvQtSDQstCy0L7QtNCwINC30LDQv9C+0LvQvdC10L3Qviwg0YLQviDRgdC+0L7RgtCy0LXRgtGB0YLQstGD0Y7RidC10LUg0LfQvdCw0YfQtdC90LjQtSDQv9C+0LTRgdCy0LXRh9C40LLQsNC10YLRgdGPINCyINGB0L/QuNGB0LrQtSDQstCw0YDQuNCw0L3RgtC+0LJcbiAgICAgIGxldCBpbnB1dFZhbHVlID0gZWxlbWVudC5maW5kKCcuY29tYm90cmVlX19pbnB1dCcpLnZhbCgpO1xuICAgICAgaWYoaW5wdXRWYWx1ZSAhPT0gJycpIHtcbiAgICAgICAgbWV0aG9kcy5zZWFyY2hJdGVtKGlucHV0VmFsdWUsIGVsZW1lbnQpO1xuICAgICAgfVxuXG4gICAgICAvLyDQntGC0LrRgNGL0YLQuNC1INGA0LDRgdC60YDRi9Cy0LDRjtGJ0LXQs9C+0YHRjyDRgdC/0LjRgdC60LBcbiAgICAgIGVsZW1lbnQuYWRkQ2xhc3MoJ29wZW4nKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICog0KHQstC+0YDQsNGH0LjQstCw0L3QuNC1INCy0YvQv9Cw0LTQsNGO0YnQtdCz0L4g0YHQv9C40YHQutCwXG4gICAgICogQHBhcmFtIHtFbGVtZW50fSBlbGVtZW50IERPTS3RjdC70LXQvNC10L3RgiDRjdC70LXQvNC10L3RgtCwLCDQtNC70Y8g0LrQvtGC0L7RgNC+0LPQviDQstGL0LfRi9Cy0LDQtdGC0YHRjyDQv9C70LDQs9C40L1cbiAgICAgKi9cbiAgICBoaWRlTGlzdDogZnVuY3Rpb24oZWxlbWVudCkge1xuICAgICAgZWxlbWVudC5maW5kKCcuY29tYm90cmVlX19saXN0LXdyYXBwZXInKS5zbGlkZVVwKCBlbGVtZW50LmRhdGEoJ3NsaWRlRHVyJykgKS51bmJpbmQoJ2NsaWNrJywgbWV0aG9kcy5vbkl0ZW1DbGljayk7XG4gICAgICBlbGVtZW50LmZpbmQoJy5jb21ib3RyZWVfX2xpc3Qtd3JhcHBlcicpLmNoaWxkcmVuKCkucmVtb3ZlQ2xhc3MoJ29wZW4nKS5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG5cbiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgIGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ29wZW4nKTtcbiAgICAgICAgZWxlbWVudC5maW5kKCcuY29tYm90cmVlX19saXN0LXdyYXBwZXInKS5yZW1vdmVDbGFzcygnb3BlblRvVG9wJykuY2hpbGRyZW4oKS5yZW1vdmUoKTtcbiAgICAgIH0sIDU1MCk7XG4gICAgfSxcblxuICAgICAvKipcbiAgICAgKiDQn9C+0LjRgdC6INCyINGB0L/QuNGB0LrQtSDQstCw0YDQuNCw0L3RgtC+0LIsINGD0LTQvtCy0LvQtdGC0LLQvtGA0Y/RjtGJ0LjQvCDQstCy0LXQtNC10L3QvdGL0Lwg0YPRgdC70L7QstC40Y/QvFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSAgc2VhcmNoQ29uZGl0aW9uINCj0YHQu9C+0LLQuNC1INC/0L7QuNGB0LrQsFxuICAgICAqIEBwYXJhbSB7RWxlbWVudH0gZWxlbWVudCBET00t0Y3Qu9C10LzQtdC90YIg0Y3Qu9C10LzQtdC90YLQsCwg0LTQu9GPINC60L7RgtC+0YDQvtCz0L4g0LLRi9C30YvQstCw0LXRgtGB0Y8g0L/Qu9Cw0LPQuNC9XG4gICAgICovXG4gICAgc2VhcmNoSXRlbTogZnVuY3Rpb24oc2VhcmNoQ29uZGl0aW9uLCBlbGVtZW50KSB7XG4gICAgICAvLyDQn9C+0LjRgdC6INCyINGB0L/QuNGB0LrQtSDQstCw0YDQuNCw0L3RgtC+0LIsINGD0LTQvtCy0LvQtdGC0LLQvtGA0Y/RjtGJ0LjRhSDQstCy0LXQtNC10L3QvdGL0Lwg0YPRgdC70L7QstC40Y/QvFxuICAgICAgZWxlbWVudC5maW5kKCcuY29tYm90cmVlX19pdGVtX2xhc3QtbGV2ZWw6Y29udGFpbnNJTihcIicgKyBzZWFyY2hDb25kaXRpb24gKyAnXCIpJykuYWRkQ2xhc3MoJ3NlYXJjaC1yZXN1bHQnKTtcblxuICAgICAgLy8g0KDQsNGB0LrRgNGL0YLQuNC1INCy0YHQtdGFINGA0L7QtNC40YLQtdC70LXQuSDQtNC70Y8g0LLQsNGA0LjQsNC90YLQvtCyLCDRg9C00L7QstC70LXRgtCy0L7RgNGP0Y7RidC40YUg0YPRgdC70L7QstC40Y/QvCDQv9C+0LjRgdC60LBcbiAgICAgIGVsZW1lbnQuZmluZCgnLnNlYXJjaC1yZXN1bHQnKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICBsZXQgYWxsUGFyZW50c0l0ZW0gPSAkKHRoaXMpLnBhcmVudHMoJy5jb21ib3RyZWVfX2l0ZW0nKTtcbiAgICAgICAgYWxsUGFyZW50c0l0ZW0uZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgICAkKHRoaXMpLmFkZENsYXNzKCdvcGVuJyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGxldCBhbGxQYXJlbnRzTGlzdCA9ICQodGhpcykucGFyZW50cygnLmNvbWJvdHJlZV9fbGlzdCcpO1xuICAgICAgICBhbGxQYXJlbnRzTGlzdC5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICQodGhpcykuYWRkQ2xhc3MoJ29wZW4nKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICog0J/QvtC40YHQuiDQt9C90LDRh9C10L3QuNGPINC/0L4g0YPQvNC+0LvRh9Cw0L3QuNGOXG4gICAgICogQHBhcmFtICB7QXJyYXl9ICBjaGlsZHJlbkRhdGEgICDQmNC90YTQvtGA0LzQsNGG0LjRjyDQviDQstCw0YDQuNCw0L3RgtCw0YUg0YHQv9C40YHQutCwXG4gICAgICogQHBhcmFtICB7U3RyaW5nfSBkZWZhdWx0VmFsdWVJZCBJRCDQt9C90LDRh9C10L3QuNGPINC/0L4g0YPQvNC+0LvRh9Cw0L3QuNGOXG4gICAgICogQHJldHVyblxuICAgICAqL1xuICAgIGZpbmREZWZhdWx0SXRlbTogZnVuY3Rpb24oY2hpbGRyZW5EYXRhLCBkZWZhdWx0VmFsdWVJZCkge1xuICAgICAgZm9yKGxldCBpID0gMDsgaSA8IGNoaWxkcmVuRGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZihjaGlsZHJlbkRhdGFbaV0uaWQgPT09IGRlZmF1bHRWYWx1ZUlkKSB7XG4gICAgICAgICAgcmV0dXJuIGNoaWxkcmVuRGF0YVtpXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmKGNoaWxkcmVuRGF0YVtpXS5jaGlsZHJlbikge1xuICAgICAgICAgIGxldCByZXMgPSBtZXRob2RzLmZpbmREZWZhdWx0SXRlbShjaGlsZHJlbkRhdGFbaV0uY2hpbGRyZW4sIGRlZmF1bHRWYWx1ZUlkKTtcbiAgICAgICAgICBpZihyZXMpIHtcbiAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBudWxsO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiDQntGC0L7QsdGA0LDQttC10L3QuNC1INGB0L7QvtCx0YnQtdC90LjRjyDQvtCxINC+0YLRgdGD0YLRgdGC0LLQuNC4INCy0LDRgNC40LDQvdGC0L7Qsiwg0YPQtNC+0LLQu9C10YLQstC+0YDRj9GO0YnQuNGFINGD0YHQu9C+0LLQuNGP0Lwg0L/QvtC40YHQutCwXG4gICAgICogQHBhcmFtIHtFbGVtZW50fSBlbGVtZW50IERPTS3RjdC70LXQvNC10L3RgiDRjdC70LXQvNC10L3RgtCwLCDQtNC70Y8g0LrQvtGC0L7RgNC+0LPQviDQstGL0LfRi9Cy0LDQtdGC0YHRjyDQv9C70LDQs9C40L1cbiAgICAgKi9cbiAgICBzaG93TGlzdE5vUmVzdWx0VGV4dDogZnVuY3Rpb24oZWxlbWVudCkge1xuICAgICAgaWYoIGVsZW1lbnQuZmluZCgnLmNvbWJvdHJlZV9fbGlzdC13cmFwcGVyJykuY2hpbGRyZW4oKS5oYXNDbGFzcygnaGlkZGVuJykgJiYgIWVsZW1lbnQuZmluZCgnLmNvbWJvdHJlZV9fc2VhcmNoX25vLXJlc3VsdCcpLmxlbmd0aCApIHtcbiAgICAgICAgJCgnPHAgY2xhc3M9XCJjb21ib3RyZWVfX3NlYXJjaF9uby1yZXN1bHRcIj7QndC40YfQtdCz0L4g0L3QtSDQvdCw0LnQtNC10L3QvjwvcD4nKS5hcHBlbmRUbyggZWxlbWVudC5maW5kKCcuY29tYm90cmVlX19saXN0LXdyYXBwZXInKSApO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiDQodC60YDRi9GC0LjQtSDQstCw0YDQuNCw0L3RgtC+0LIsINC60L7RgtC+0YDRi9C1INGD0YHQu9C+0LLQuNGP0Lwg0L3QtSDRg9C00L7QstC70LXRgtCy0L7RgNGP0Y7Rgiwg0LAg0YLQsNC60LbQtSDQv9GD0YHRgtGL0YUgJ9GA0L7QtNC40YLQtdC70LXQuSdcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1lbnQgRE9NLdGN0LvQtdC80LXQvdGCLCDQutC+0YLQvtGA0YvQuSDQvdGD0LbQvdC+INGB0LrRgNGL0YLRjFxuICAgICAqL1xuICAgIGhpZGVMaXN0T3B0aW9uc05vdENvbXBseVNlYXJjaENvbmRpdGlvbnM6IGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICAgIC8vINCh0LrRgNGL0YLQuNC1INGC0LXRhSDQstCw0YDQuNCw0L3RgtC+0LIsINC60L7RgtC+0YDRi9C1INGD0YHQu9C+0LLQuNGP0Lwg0L3QtSDRg9C00L7QstC70LXRgtCy0L7RgNGP0Y7RglxuICAgICAgZWxlbWVudC5maW5kKCcuY29tYm90cmVlX19pdGVtX2xhc3QtbGV2ZWwnKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiggISQodGhpcykuaGFzQ2xhc3MoJ3NlYXJjaC1yZXN1bHQnKSApIHtcbiAgICAgICAgICAkKHRoaXMpLmFkZENsYXNzKCdoaWRkZW4nKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIC8vINCh0LrRgNGL0YLQuNC1INC/0YPRgdGC0YvRhSDRgNC+0LTQuNGC0LXQu9C10LlcbiAgICAgIGVsZW1lbnQuZmluZCgnLmNvbWJvdHJlZV9fbGlzdCcpLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgIG1ldGhvZHMuaGlkZUxpc3RFbXB0eVBhcmVudHMoICQodGhpcykgKTtcbiAgICAgIH0pO1xuXG4gICAgICBlbGVtZW50LmZpbmQoJy5jb21ib3RyZWVfX2l0ZW0nKS5ub3QoJy5jb21ib3RyZWVfX2l0ZW1fbGFzdC1sZXZlbCcpLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgIG1ldGhvZHMuaGlkZUxpc3RFbXB0eVBhcmVudHMoICQodGhpcykgKTtcbiAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiDQodC60YDRi9GC0LjQtSDQv9GD0YHRgtGL0YUg0Y3Qu9C10LzQtdC90YLQvtCyINC90LXQutC+0L3QtdGH0L3QvtCz0L4g0YPRgNC+0LLQvdGPXG4gICAgICogQHBhcmFtIHtFbGVtZW50fSBlbGVtZW50IERPTS3RjdC70LXQvNC10L3Rgiwg0LrQvtGC0L7RgNGL0Lkg0L3Rg9C20L3QviDRgdC60YDRi9GC0YxcbiAgICAgKi9cbiAgICBoaWRlTGlzdEVtcHR5UGFyZW50czogZnVuY3Rpb24oZWxlbWVudCkge1xuICAgICAgbGV0IGhhc1Nob3dMaXN0ZWRJdGVtID0gZmFsc2U7XG4gICAgICBsZXQgbGFzdExldmVsID0gZWxlbWVudC5maW5kKCcuY29tYm90cmVlX19pdGVtX2xhc3QtbGV2ZWwnKTtcbiAgICAgIGxhc3RMZXZlbC5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiggJCh0aGlzKS5oYXNDbGFzcygnc2VhcmNoLXJlc3VsdCcpICkge1xuICAgICAgICAgIGhhc1Nob3dMaXN0ZWRJdGVtID0gdHJ1ZTtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBpZighaGFzU2hvd0xpc3RlZEl0ZW0pIHtcbiAgICAgICAgZWxlbWVudC5yZW1vdmVDbGFzcygnb3BlbicpLmFkZENsYXNzKCdoaWRkZW4nKTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICog0KHQsdGA0L7RgSDRgNC10LfRg9C70YzRgtCw0YLQvtCyINC/0L7QuNGB0LrQsFxuICAgICAqIEBwYXJhbSB7RWxlbWVudH0gZWxlbWVudCBET00t0Y3Qu9C10LzQtdC90YIg0Y3Qu9C10LzQtdC90YLQsCwg0LTQu9GPINC60L7RgtC+0YDQvtCz0L4g0LLRi9C30YvQstCw0LXRgtGB0Y8g0L/Qu9Cw0LPQuNC9XG4gICAgICovXG4gICAgcmVzZXRTZWFyY2hSZXN1bHQ6IGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICAgIGVsZW1lbnQuZmluZCgnLmNvbWJvdHJlZV9fbGlzdCcpLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTtcbiAgICAgIGVsZW1lbnQuZmluZCgnLmNvbWJvdHJlZV9faXRlbScpLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTtcbiAgICAgIGVsZW1lbnQuZmluZCgnLmNvbWJvdHJlZV9faXRlbV9sYXN0LWxldmVsJykucmVtb3ZlQ2xhc3MoJ3NlYXJjaC1yZXN1bHQnKTtcbiAgICAgIGVsZW1lbnQuZmluZCgnLmNvbWJvdHJlZV9fc2VhcmNoX25vLXJlc3VsdCcpLnJlbW92ZSgpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiDQntCx0YDQsNCx0L7RgtGH0LjQuiDRgdC+0LHRi9GC0LjRjyDQuNC30LzQtdC90LXQvdC40Y8g0LfQvdCw0YfQtdC90LjRjyDQv9C+0LvRjyDQstCy0L7QtNCwXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGV2ZW50XG4gICAgICovXG4gICAgb25JbnB1dENoYW5nZTogZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIGxldCAkaW5wdXQgPSAkKGV2ZW50LnRhcmdldCk7XG4gICAgICBsZXQgJGNvbWJvdHJlZSA9ICQoZXZlbnQudGFyZ2V0KS5wYXJlbnRzKCcuY29tYm90cmVlJyk7XG4gICAgICBpZiAoJGlucHV0LnZhbCgpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAvLyDQo9GB0LvQvtCy0LjQtSDQv9C+0LjRgdC60LAg0L3QtSDQstCy0LXQtNC10L3QvlxuICAgICAgICBpZiggJGNvbWJvdHJlZS5oYXNDbGFzcygnb3BlbicpICkge1xuICAgICAgICAgIG1ldGhvZHMucmVzZXRTZWFyY2hSZXN1bHQoJGNvbWJvdHJlZSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vINCj0YHQu9C+0LLQuNC1INC/0L7QuNGB0LrQsCDQstCy0LXQtNC10L3QvlxuICAgICAgICBpZiggJGNvbWJvdHJlZS5oYXNDbGFzcygnb3BlbicpICkge1xuICAgICAgICAgIC8vINCh0L/QuNGB0L7QuiDQstCw0YDQuNCw0L3RgtC+0LIg0YDQsNGB0LrRgNGL0YJcbiAgICAgICAgICBtZXRob2RzLnJlc2V0U2VhcmNoUmVzdWx0KCRjb21ib3RyZWUpO1xuICAgICAgICAgIG1ldGhvZHMuc2VhcmNoSXRlbSgkaW5wdXQudmFsKCksICRjb21ib3RyZWUpO1xuICAgICAgICAgIG1ldGhvZHMuaGlkZUxpc3RPcHRpb25zTm90Q29tcGx5U2VhcmNoQ29uZGl0aW9ucygkY29tYm90cmVlKTtcbiAgICAgICAgICBtZXRob2RzLnNob3dMaXN0Tm9SZXN1bHRUZXh0KCRjb21ib3RyZWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vINCh0L/QuNGB0L7QuiDQstCw0YDQuNCw0L3RgtC+0LIg0YHQstC10YDQvdGD0YJcbiAgICAgICAgICBtZXRob2RzLnNob3dMaXN0KCRjb21ib3RyZWUpO1xuICAgICAgICAgIG1ldGhvZHMuc2VhcmNoSXRlbSgkaW5wdXQudmFsKCksICRjb21ib3RyZWUpO1xuICAgICAgICAgIG1ldGhvZHMuaGlkZUxpc3RPcHRpb25zTm90Q29tcGx5U2VhcmNoQ29uZGl0aW9ucygkY29tYm90cmVlKTtcbiAgICAgICAgICBtZXRob2RzLnNob3dMaXN0Tm9SZXN1bHRUZXh0KCRjb21ib3RyZWUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqINCe0LHRgNCw0LHQvtGC0YfQuNC6INGB0L7QsdGL0YLQuNGPINC90LDQttCw0YLQuNGPINC90LAg0LrQvdC+0L/QutGDINGA0LDRgdC60YDRi9GC0LjRjyDQstGL0L/QsNC00LDRjtGJ0LXQs9C+INGB0L/QuNGB0LrQsFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBldmVudFxuICAgICAqL1xuICAgIG9uU2VsZWN0Q2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgbGV0ICRjb21ib3RyZWUgPSAkKGV2ZW50LnRhcmdldCkucGFyZW50cygnLmNvbWJvdHJlZScpO1xuICAgICAgaWYoICRjb21ib3RyZWUuaGFzQ2xhc3MoJ29wZW4nKSApIHtcbiAgICAgICAgLy8g0KHQv9C40YHQvtC6INCy0LDRgNC40LDQvdGC0L7QsiDRgNCw0LfQstC10YDQvdGD0YJcbiAgICAgICAgbWV0aG9kcy5oaWRlTGlzdCgkY29tYm90cmVlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vINCh0L/QuNGB0L7QuiDQstCw0YDQuNCw0L3RgtC+0LIg0YHQstC10YDQvdGD0YJcbiAgICAgICAgbWV0aG9kcy5zaG93TGlzdCgkY29tYm90cmVlKTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICog0J7QsdGA0LDQsdC+0YLRh9C40Log0YHQvtCx0YvRgtC40Y8g0L3QsNC20LDRgtC40Y8g0L3QsCDRjdC70LXQvNC10L3RgiDRgdC/0LjRgdC60LBcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZXZlbnRcbiAgICAgKi9cbiAgICBvbkl0ZW1DbGljazogZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgbGV0ICRpdGVtID0gJChldmVudC50YXJnZXQpO1xuICAgICAgbGV0ICRjb21ib3RyZWUgPSAkaXRlbS5wYXJlbnRzKCcuY29tYm90cmVlJyk7XG4gICAgICBpZigkaXRlbS5oYXNDbGFzcygnY29tYm90cmVlX19pdGVtJykpIHtcbiAgICAgICAgLy8g0J3QsNC20LDRgiDRjdC70LXQvNC10L3RgiDRgdC/0LjRgdC60LBcbiAgICAgICAgaWYoJGl0ZW0uaGFzQ2xhc3MoJ2NvbWJvdHJlZV9faXRlbV9sYXN0LWxldmVsJykpIHtcbiAgICAgICAgICAvLyDQndCw0LbQsNGCINGN0LvQtdC80LXQvdGCINC/0L7RgdC70LXQtNC90LXQs9C+INGD0YDQvtCy0L3Rj1xuICAgICAgICAgICRjb21ib3RyZWUuZmluZCgnLmNvbWJvdHJlZV9faW5wdXQnKS52YWwoJGl0ZW0udGV4dCgpKTtcbiAgICAgICAgICBtZXRob2RzLmhpZGVMaXN0KCRjb21ib3RyZWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vINCd0LDQttCw0YIg0Y3Qu9C10LzQtdC90YIg0L3QtSDQv9C+0YHQu9C10LTQvdC10LPQviDRg9GA0L7QstC90Y9cbiAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICBpZigkaXRlbS5oYXNDbGFzcygnb3BlbicpKSB7XG4gICAgICAgICAgICAvLyDQrdC70LXQvNC10L3RgiDRgNCw0LfQstC10YDQvdGD0YJcbiAgICAgICAgICAgICRpdGVtLmNoaWxkcmVuKCkuc2xpZGVVcCggJGNvbWJvdHJlZS5kYXRhKCdzbGlkZUR1cicpICk7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAkaXRlbS5yZW1vdmVDbGFzcygnb3BlbicpO1xuICAgICAgICAgICAgfSwgNDAwKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8g0K3Qu9C10LzQtdC90YIg0YHQstC10YDQvdGD0YJcbiAgICAgICAgICAgICRpdGVtLmNoaWxkcmVuKCkuc2xpZGVEb3duKCAkY29tYm90cmVlLmRhdGEoJ3NsaWRlRHVyJykgKTtcbiAgICAgICAgICAgICRpdGVtLmFkZENsYXNzKCdvcGVuJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqINCe0LHRgNCw0LHQvtGC0YfQuNC6INGB0L7QsdGL0YLQuNGPINGJ0LXQu9GH0LrQsCDQvNGL0YjRjNGOINCyINC70Y7QsdC+0Lkg0LzQtdGB0YLQtSDRjdC60YDQsNC90LAsINC60YDQvtC80LUg0L7QsdC70LDRgdGC0LggY29tYm90cmVlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGV2ZW50XG4gICAgICovXG4gICAgb25XaW5kb3dNb3VzZVVwOiBmdW5jdGlvbihldmVudCkge1xuICAgICAgaWYoICQoJy5jb21ib3RyZWUub3BlbicpLmhhcyhldmVudC50YXJnZXQpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBtZXRob2RzLmhpZGVMaXN0KCAkKCcuY29tYm90cmVlLm9wZW4nKSApO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICAkLmZuLmNvbWJvdHJlZSA9IGZ1bmN0aW9uKHNldHRpbmdzKSB7XG4gICAgcmV0dXJuIG1ldGhvZHMuaW5pdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xufSkoalF1ZXJ5KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9qcXVlcnkuY29tYm90cmVlLmpzIl0sInNvdXJjZVJvb3QiOiIifQ==